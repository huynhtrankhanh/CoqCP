<!doctype html>
<html class="alectryon-standalone">
  <head>
    <title>SwapUpdate.v</title>
    <meta charset="utf-8" />
    <meta content="Alectryon" name="generator" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="alectryon.css" rel="stylesheet" />
    <link href="pygments.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css"
      integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw=="
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css"
      integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA=="
      crossorigin="anonymous"
    />
    <script src="alectryon.js"></script>
  </head>
  <body>
    <article class="alectryon-root alectryon-centered">
      <div class="alectryon-banner">
        Built with
        <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>,
        running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span
          class="alectryon-bubble"
        ></span
        >) indicate interactive fragments: hover for details, tap to reveal
        contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate,
        <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of
        <kbd>Ctrl</kbd>.
      </div>
      <pre
        class="alectryon-io highlight"
      ><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk0"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> numbers list.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file ssrmatching_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file ssreflect_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> CoqCP <span class="kn">Require Import</span> Options ListDecomposition ListsEqual.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* all indices 0 based *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">swap</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">default</span> : A) :=
  <span class="kr">let</span> <span class="nv">leftElement</span> := nth i l default <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">rightElement</span> := nth j l default <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">updated</span> := &lt;[i := rightElement]&gt; l <span class="kr">in</span>
  &lt;[j := leftElement]&gt; updated.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1"><span class="kn">Lemma</span> <span class="nf">updateAtIndexLength</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">value</span> : A) : &lt;[length l := value]&gt; l = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l:=value]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l:=value]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l <span class="kr">as</span> [| head l IHl]; <span class="nb">unfold</span> alter; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> alter <span class="kr">in</span> IHl; <span class="nb">rewrite</span> IHl; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk3"><span class="kn">Lemma</span> <span class="nf">updateAtIndexLengthPlusSomething</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">value</span> : A) (<span class="nv">something</span> : nat) : &lt;[length l + something := value]&gt; l = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>something</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l + something:=value]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>something</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l + something:=value]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l <span class="kr">as</span> [| head l IHl]; <span class="nb">unfold</span> alter; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> alter <span class="kr">in</span> IHl; <span class="nb">rewrite</span> IHl; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk5"><span class="kn">Lemma</span> <span class="nf">updateApp</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">value</span> : A) (<span class="nv">i</span> : nat) : &lt;[length l1 + i := value]&gt; (l1 ++ l2) = l1 ++ &lt;[i := value]&gt; l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l1 + i:=value]&gt; (l1 ++ l2) =
l1 ++ &lt;[i:=value]&gt; l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l1 + i:=value]&gt; (l1 ++ l2) =
l1 ++ &lt;[i:=value]&gt; l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head l1 IHl1]; <span class="nb">unfold</span> alter; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> alter <span class="kr">in</span> IHl1; <span class="nb">rewrite</span> IHl1; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk7"><span class="kn">Lemma</span> <span class="nf">updateAppZero</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">value</span> : A) : &lt;[length l1 := value]&gt; (l1 ++ l2) = l1 ++ &lt;[<span class="mi">0</span> := value]&gt; l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l1:=value]&gt; (l1 ++ l2) =
l1 ++ &lt;[<span class="mi">0</span>:=value]&gt; l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[length l1:=value]&gt; (l1 ++ l2) =
l1 ++ &lt;[<span class="mi">0</span>:=value]&gt; l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head l1 IHl1]; <span class="nb">unfold</span> alter; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> alter <span class="kr">in</span> IHl1; <span class="nb">rewrite</span> IHl1; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk9"><span class="kn">Lemma</span> <span class="nf">nthApp</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">i</span> : nat) (<span class="nv">default</span> : A) : nth (length l1 + i) (l1 ++ l2) default = nth i l2 default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (length l1 + i) (l1 ++ l2) default =
nth i l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (length l1 + i) (l1 ++ l2) default =
nth i l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head l1 IHl1]; <span class="nb">unfold</span> nth; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> nth <span class="kr">in</span> IHl1; <span class="nb">rewrite</span> IHl1; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb"><span class="kn">Lemma</span> <span class="nf">nthAppZero</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">default</span> : A) : nth (length l1) (l1 ++ l2) default = nth <span class="mi">0</span> l2 default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (length l1) (l1 ++ l2) default = nth <span class="mi">0</span> l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (length l1) (l1 ++ l2) default = nth <span class="mi">0</span> l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head l1 IHl1]; <span class="nb">unfold</span> nth; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> nth <span class="kr">in</span> IHl1; <span class="nb">rewrite</span> IHl1; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd"><span class="kn">Lemma</span> <span class="nf">swapChopOff</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">default</span> : A) : <span class="nb">swap</span> (l1 ++ l2) (length l1 + i) (length l1 + j) default = l1 ++ <span class="nb">swap</span> l2 i j default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (l1 ++ l2) (length l1 + i) (length l1 + j)
  default = l1 ++ <span class="nb">swap</span> l2 i j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (l1 ++ l2) (length l1 + i) 
  (length l1 + j) default = 
l1 ++ <span class="nb">swap</span> l2 i j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head l1 IHl1]; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span> (l1 ++ l2) (length l1 + i) 
  (length l1 + j) default =
l1 ++ <span class="nb">swap</span> l2 i j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (head :: l1 ++ l2) 
  (S (length l1 + i)) (S (length l1 + j)) default =
head :: l1 ++ <span class="nb">swap</span> l2 i j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk10"><span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span> (l1 ++ l2) (length l1 + i) 
  (length l1 + j) default =
l1 ++ <span class="nb">swap</span> l2 i j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[S (length l1 + j):=nth 
                      (S (length l1 + i))
                      (head :: l1 ++ l2) default]&gt;
  (&lt;[S (length l1 + i):=
     nth (S (length l1 + j)) 
       (head :: l1 ++ l2) default]&gt; 
     (head :: l1 ++ l2)) =
head
:: l1 ++
   &lt;[j:=nth i l2 default]&gt;
     (&lt;[i:=nth j l2 default]&gt; l2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> i; <span class="nb">destruct</span> j; <span class="nb">destruct</span> l1; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span> <span class="kr">in</span> IHl1; <span class="nb">rewrite</span> <span class="nl">?IHl1</span>, <span class="nl">?app_nil_r</span>, <span class="nl">?Nat</span>.add_0_r; <span class="nb">simpl</span>; <span class="nb">rewrite</span> <span class="nl">?updateAtIndexLength</span>, <span class="nl">?updateAtIndexLengthPlusSomething</span>, <span class="nl">?updateApp</span>, <span class="nl">?updateAppZero</span>, <span class="nl">?nthApp</span>, <span class="nl">?nthAppZero</span>, <span class="nl">?updateApp</span>; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk11"><span class="kn">Lemma</span> <span class="nf">swapChopOff&#39;</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">j</span> : nat) (<span class="nv">default</span> : A) : <span class="nb">swap</span> (l1 ++ l2) (length l1) (length l1 + j) default = l1 ++ <span class="nb">swap</span> l2 <span class="mi">0</span> j default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (l1 ++ l2) (length l1) (length l1 + j) default =
l1 ++ <span class="nb">swap</span> l2 <span class="mi">0</span> j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk12"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (l1 ++ l2) (length l1) (length l1 + j) default =
l1 ++ <span class="nb">swap</span> l2 <span class="mi">0</span> j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk13"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head l1 IHl1]; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span> (l1 ++ l2) (length l1) 
  (length l1 + j) default =
l1 ++ <span class="nb">swap</span> l2 <span class="mi">0</span> j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (head :: l1 ++ l2) 
  (S (length l1)) (S (length l1 + j)) default =
head :: l1 ++ <span class="nb">swap</span> l2 <span class="mi">0</span> j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk14"><span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span> (l1 ++ l2) (length l1) 
  (length l1 + j) default =
l1 ++ <span class="nb">swap</span> l2 <span class="mi">0</span> j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[S (length l1 + j):=nth 
                      (S (length l1))
                      (head :: l1 ++ l2) default]&gt;
  (&lt;[S (length l1):=nth 
                      (S (length l1 + j))
                      (head :: l1 ++ l2) default]&gt;
     (head :: l1 ++ l2)) =
head
:: l1 ++
   &lt;[j:=nth <span class="mi">0</span> l2 default]&gt;
     (&lt;[<span class="mi">0</span>:=nth j l2 default]&gt; l2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> j; <span class="nb">destruct</span> l1; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span> <span class="kr">in</span> IHl1; <span class="nb">rewrite</span> <span class="nl">?IHl1</span>, <span class="nl">?app_nil_r</span>, <span class="nl">?Nat</span>.add_0_r; <span class="nb">simpl</span>; <span class="nb">rewrite</span> <span class="nl">?updateAtIndexLength</span>, <span class="nl">?updateAtIndexLengthPlusSomething</span>, <span class="nl">?updateApp</span>, <span class="nl">?updateAppZero</span>, <span class="nl">?nthApp</span>, <span class="nl">?nthAppZero</span>, <span class="nl">?updateApp</span>; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk15"><span class="kn">Lemma</span> <span class="nf">swapApp</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> <span class="nv">l3</span> : list A) (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">default</span> : A) : <span class="nb">swap</span> (l1 ++ [a] ++ l2 ++ [b] ++ l3) (length l1) (length l1 + length l2 + <span class="mi">1</span>) default = l1 ++ [b] ++ l2 ++ [a] ++ l3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (l1 ++ [a] ++ l2 ++ [b] ++ l3) (length l1)
  (length l1 + length l2 + <span class="mi">1</span>) default =
l1 ++ [b] ++ l2 ++ [a] ++ l3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk16"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (l1 ++ [a] ++ l2 ++ [b] ++ l3) 
  (length l1) (length l1 + length l2 + <span class="mi">1</span>) default =
l1 ++ [b] ++ l2 ++ [a] ++ l3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17"><span class="nb">rewrite</span> &lt;- Nat.add_assoc, swapChopOff&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
<span class="nb">swap</span> ([a] ++ l2 ++ [b] ++ l3) <span class="mi">0</span> 
  (length l2 + <span class="mi">1</span>) default =
l1 ++ [b] ++ l2 ++ [a] ++ l3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk18"><span class="nb">induction</span> l2; <span class="nb">simpl</span>; <span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
&lt;[<span class="mi">1</span>:=nth <span class="mi">0</span> (a :: b :: l3) default]&gt;
  (&lt;[<span class="mi">0</span>:=nth <span class="mi">1</span> (a :: b :: l3) default]&gt; (a :: b :: l3)) =
l1 ++ b :: a :: l3</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk19"><hr></label><div class="goal-conclusion">l1 ++
&lt;[S (length _1 + <span class="mi">1</span>):=nth <span class="mi">0</span> 
                      (a :: _0 :: _1 ++ b :: l3)
                      default]&gt;
  (&lt;[<span class="mi">0</span>:=nth (S (length _1 + <span class="mi">1</span>))
          (a :: _0 :: _1 ++ b :: l3) default]&gt;
     (a :: _0 :: _1 ++ b :: l3)) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
&lt;[<span class="mi">1</span>:=nth <span class="mi">0</span> (a :: b :: l3) default]&gt;
  (&lt;[<span class="mi">0</span>:=nth <span class="mi">1</span> (a :: b :: l3) default]&gt; (a :: b :: l3)) =
l1 ++ b :: a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b"><span class="nb">unfold</span> alter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
&lt;[<span class="mi">1</span>:=nth <span class="mi">0</span> (a :: b :: l3) default]&gt;
  (&lt;[<span class="mi">0</span>:=nth <span class="mi">1</span> (a :: b :: l3) default]&gt; (a :: b :: l3)) =
l1 ++ b :: a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1c"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++ b :: a :: l3 = l1 ++ b :: a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
&lt;[S (length _1 + <span class="mi">1</span>):=nth <span class="mi">0</span> 
                      (a :: _0 :: _1 ++ b :: l3)
                      default]&gt;
  (&lt;[<span class="mi">0</span>:=nth (S (length _1 + <span class="mi">1</span>))
          (a :: _0 :: _1 ++ b :: l3) default]&gt;
     (a :: _0 :: _1 ++ b :: l3)) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1e"><span class="nb">rewrite</span> Nat.add_1_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
&lt;[S (S (length _1)):=nth <span class="mi">0</span> 
                      (a :: _0 :: _1 ++ b :: l3)
                      default]&gt;
  (&lt;[<span class="mi">0</span>:=nth (S (S (length _1)))
          (a :: _0 :: _1 ++ b :: l3) default]&gt;
     (a :: _0 :: _1 ++ b :: l3)) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1f"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
nth (length _1) (_1 ++ b :: l3) default
:: _0 :: &lt;[length _1:=a]&gt; (_1 ++ b :: l3) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk20"><span class="nb">rewrite</span> nthAppZero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++
nth <span class="mi">0</span> (b :: l3) default
:: _0 :: &lt;[length _1:=a]&gt; (_1 ++ b :: l3) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk21"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++ b :: _0 :: &lt;[length _1:=a]&gt; (_1 ++ b :: l3) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk22"><span class="nb">rewrite</span> updateAppZero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++ b :: _0 :: _1 ++ &lt;[<span class="mi">0</span>:=a]&gt; (b :: l3) =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk23"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1, l3</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a, b, default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>l1 ++
<span class="nb">swap</span> ([a] ++ _1 ++ [b] ++ l3) <span class="mi">0</span> 
  (length _1 + <span class="mi">1</span>) default =
l1 ++ [b] ++ _1 ++ [a] ++ l3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ++ b :: _0 :: _1 ++ a :: l3 =
l1 ++ b :: _0 :: _1 ++ a :: l3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk24"><span class="kn">Lemma</span> <span class="nf">swapPreservesLength</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) : length (<span class="nb">swap</span> l i j default) = length l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (<span class="nb">swap</span> l i j default) = length l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk25"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (<span class="nb">swap</span> l i j default) = length l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk26"><span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length
  (&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l)) =
length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk27"><span class="nb">rewrite</span> <span class="nl">?insert_length</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length l = length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk28"><span class="kn">Lemma</span> <span class="nf">updateSelf</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> : nat) : &lt;[i := nth i l default]&gt; l = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[i:=nth i l default]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk29"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[i:=nth i l default]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2a"><span class="nb">revert</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat, &lt;[_0:=nth _0 l default]&gt; l = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l <span class="kr">as</span> [| head l IHl]; <span class="nb">intro</span> i; <span class="nb">simpl</span>; <span class="nb">destruct</span> i; <span class="kp">try</span> <span class="nb">simpl</span>; <span class="nb">rewrite</span> <span class="nl">?IHl</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2b"><span class="kn">Lemma</span> <span class="nf">swapSelf</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> : nat) : <span class="nb">swap</span> l i i default = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> l i i default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> l i i default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2d"><span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[i:=nth i l default]&gt; (&lt;[i:=nth i l default]&gt; l) = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2e"><span class="nb">rewrite</span> <span class="nl">?updateSelf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk2f"><span class="kn">Lemma</span> <span class="nf">nthTake</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hLt</span> : i &lt; j) : nth i l default = nth i (take j l) default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default = nth i (take j l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default = nth i (take j l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk31"><span class="nb">revert</span> l hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  i &lt; j ‚Üí nth i _0 default = nth i (take j _0) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk32"><span class="nb">revert</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default = nth i (take _0 _1) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk33"><span class="nb">induction</span> i <span class="kr">as</span> [| i IHi]; <span class="nb">intros</span> j l hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth <span class="mi">0</span> l default = nth <span class="mi">0</span> (take j l) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk34"><hr></label><div class="goal-conclusion">nth (S i) l default = nth (S i) (take j l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk35">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth <span class="mi">0</span> l default = nth <span class="mi">0</span> (take j l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk36"><span class="nb">destruct</span> l; <span class="nb">rewrite</span> <span class="nl">?take_nil</span>; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">default = default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk37"><hr></label><div class="goal-conclusion">_0 = nth <span class="mi">0</span> (take j (_0 :: _1)) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk38">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">default = default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk39">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_0 = nth <span class="mi">0</span> (take j (_0 :: _1)) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk3a"><span class="nb">destruct</span> j; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_0 = nth <span class="mi">0</span> (take (S _2) (_0 :: _1)) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk3b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_0 = _0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk3c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (S i) l default = nth (S i) (take j l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk3d"><span class="nb">destruct</span> l; <span class="nb">rewrite</span> <span class="nl">?take_nil</span>; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">default = default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk3e"><hr></label><div class="goal-conclusion">nth i _1 default =
nth (S i) (take j (_0 :: _1)) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk3f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">default = default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk40">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i _1 default =
nth (S i) (take j (_0 :: _1)) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk41"><span class="nb">destruct</span> j; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; S _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i _1 default =
nth (S i) (take (S _2) (_0 :: _1)) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk42"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; S _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i _1 default = nth i (take _2 _1) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk43"><span class="nb">apply</span> IHi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : nat) (<span class="nv">_1</span> : list A),
  i &lt; _0
  ‚Üí nth i _1 default =
    nth i (take _0 _1) default</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; S _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; _2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk44"><span class="kn">Lemma</span> <span class="nf">nthConsDrop</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">hNotNil</span> : l &lt;&gt; []) (<span class="nv">i</span> : nat) (<span class="nv">hLt</span> : i &lt; length l) : nth i l default :: drop (S i) l = drop i l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>l ‚â† []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default :: drop (S i) l = drop i l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk45"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>l ‚â† []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default :: drop (S i) l = drop i l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk46"><span class="nb">revert</span> hNotNil hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â† []
‚Üí i &lt; length l
  ‚Üí nth i l default :: drop (S i) l = drop i l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk47"><span class="nb">revert</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 = drop i _0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk48"><span class="nb">induction</span> i <span class="kr">as</span> [| i IHi]; <span class="nb">intros</span> l hNotNil hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>l ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth <span class="mi">0</span> l default :: drop <span class="mi">1</span> l = drop <span class="mi">0</span> l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk49" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>l ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length l</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk49"><hr></label><div class="goal-conclusion">nth (S i) l default :: drop (S (S i)) l = drop (S i) l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk4a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>l ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth <span class="mi">0</span> l default :: drop <span class="mi">1</span> l = drop <span class="mi">0</span> l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> l; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk4b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>l ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (S i) l default :: drop (S (S i)) l = drop (S i) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk4c"><span class="nb">destruct</span> l; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length (_0 :: _1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i _1 default :: drop (S i) _1 = drop i _1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk4d"><span class="nb">apply</span> IHi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length (_0 :: _1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_1 ‚â† []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk4e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length (_0 :: _1)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk4e"><hr></label><div class="goal-conclusion">i &lt; length _1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk4f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length (_0 :: _1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_1 ‚â† []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk50"><span class="nb">intro</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length (_0 :: _1)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>_1 = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk51"><span class="nb">rewrite</span> h <span class="kr">in</span> hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length [_0]</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>_1 = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk52"><span class="nb">simpl</span> <span class="kr">in</span> hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; <span class="mi">1</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>_1 = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk53">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; length (_0 :: _1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; length _1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk54"><span class="nb">simpl</span> <span class="kr">in</span> hLt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  _0 ‚â† []
  ‚Üí i &lt; length _0
    ‚Üí nth i _0 default :: drop (S i) _0 =
      drop i _0</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hNotNil</var><span class="hyp-type"><b>: </b><span>_0 :: _1 ‚â† []</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S i &lt; S (length _1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; length _1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk55"><span class="kn">Lemma</span> <span class="nf">swapIndices</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) : <span class="nb">swap</span> l i j default = <span class="nb">swap</span> l j i default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> l i j default = <span class="nb">swap</span> l j i default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk56"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> l i j default = <span class="nb">swap</span> l j i default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk57"><span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk58"><span class="nb">assert</span> (hCases : i = j \/ i &lt;&gt; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = j ‚à® i ‚â† j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hCases</var><span class="hyp-type"><b>: </b><span>i = j ‚à® i ‚â† j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk59"><hr></label><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk5a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = j ‚à® i ‚â† j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk5b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hCases</var><span class="hyp-type"><b>: </b><span>i = j ‚à® i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk5c"><span class="nb">destruct</span> hCases <span class="kr">as</span> [h | h].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk5d"><hr></label><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk5e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk5f"><span class="nb">rewrite</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[j:=nth j l default]&gt; (&lt;[j:=nth j l default]&gt; l) =
&lt;[j:=nth j l default]&gt; (&lt;[j:=nth j l default]&gt; l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk60">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk61"><span class="nb">rewrite</span> list_insert_commute; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l) =
&lt;[i:=nth j l default]&gt; (&lt;[j:=nth i l default]&gt; l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk62"><span class="kn">Lemma</span> <span class="nf">swapTwice&#39;</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hIJ</span> : i &lt; j) (<span class="nv">hJ</span> : j &lt; length l) : <span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk64"><span class="nb">rewrite</span> (listDecomposition l i j <span class="kp">ltac</span>:(<span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="bp">lia</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk65"><span class="nb">assert</span> (takeLength : i = length (take i l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk66"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk67">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk68"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = i `min` length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk69">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk6a"><span class="nb">assert</span> (hRewrite : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) i j default = <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk6b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l) i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk6b"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk6c">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk6d"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>_0, _1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l) i
  j default =
<span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk6e"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>_0, _1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l) i
  j default =
<span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l) i
  j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk6f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l) i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk70"><span class="nb">rewrite</span> hRewrite.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l) i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk71"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk72"><span class="nb">assert</span> (takeLength : j = length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk73"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk74">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk75"><span class="nb">rewrite</span> take_length, drop_length, take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk76"><span class="nb">assert</span> (subtask1 : i `min` length l = i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk77" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk77"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk78">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk79">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk7a"><span class="nb">assert</span> (subtask2 : j `min` length l = j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk7b"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk7c">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk7d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk7e"><span class="nb">rewrite</span> subtask1, subtask2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i + (j - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk7f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk80"><span class="nb">assert</span> (hRewrite : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default = <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) (length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk81" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>)
    default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk81"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk82">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk83"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk84">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>)
    default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk85"><span class="nb">rewrite</span> hRewrite, swapApp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>)
    default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk86"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk87"><span class="nb">assert</span> (takeLength : i = length (take i l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk88" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk88"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk89">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk8a"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = i `min` length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk8b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk8c"><span class="nb">assert</span> (hRewrite : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) i j default = <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk8d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l) i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk8d"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk8e">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk8f"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>_0, _1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l) i
  j default =
<span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk90"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>_0, _1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l) i
  j default =
<span class="nb">swap</span>
  (take i l ++
   [_0] ++
   drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l) i
  j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk91">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l) i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk92"><span class="nb">rewrite</span> hRewrite.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l) i j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk93"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk94"><span class="nb">assert</span> (takeLength : j = length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk95"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk96">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk97"><span class="nb">rewrite</span> take_length, drop_length, take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk98"><span class="nb">assert</span> (subtask1 : i `min` length l = i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk99" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk99"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk9a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk9b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk9c"><span class="nb">assert</span> (subtask2 : j `min` length l = j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk9d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk9d"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk9e">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk9f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka0"><span class="nb">rewrite</span> subtask1, subtask2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i + (j - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka1">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka2"><span class="nb">assert</span> (hRewrite : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default = <span class="nb">swap</span> (take i l ++ [x] ++ drop (S i) (take j l) ++ [y] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) (length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chka3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>)
    default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chka3"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka4">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka5"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++ [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka6">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>)
    default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka7"><span class="nb">rewrite</span> hRewrite, swapApp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : A,
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l)) j default =
  <span class="nb">swap</span>
    (take i l ++
     [_0] ++
     drop (S i) (take j l) ++
     [_1] ++ drop (j + <span class="mi">1</span>) l)
    (length (take i l))
    (length (take i l) +
     length (drop (S i) (take j l)) + <span class="mi">1</span>)
    default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka8"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chka9"><span class="kn">Lemma</span> <span class="nf">swapTwice</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hI</span> : i &lt; length l) (<span class="nv">hJ</span> : j &lt; length l) : <span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkaa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkab"><span class="nb">assert</span> (hWlog : i &lt; j \/ j &lt; i \/ i = j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; j ‚à® j &lt; i ‚à® i = j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkac" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j ‚à® j &lt; i ‚à® i = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkac"><hr></label><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkad">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; j ‚à® j &lt; i ‚à® i = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkae">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j ‚à® j &lt; i ‚à® i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkaf"><span class="nb">destruct</span> hWlog <span class="kr">as</span> [hWlog | [hWlog | hWlog]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkb0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkb0"><hr></label><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkb1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkb1"><hr></label><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> swapTwice&#39;; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb4"><span class="nb">rewrite</span> ?(swapIndices _ default i j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l j i default) j i default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (swapTwice&#39; _ _ j i); <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb6"><span class="nb">rewrite</span> hWlog, <span class="nl">?swapSelf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb7"><span class="kn">Lemma</span> <span class="nf">swapTwiceVariant</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hI</span> : i &lt; length l) (<span class="nv">hJ</span> : j &lt; length l) : <span class="nb">swap</span> (<span class="nb">swap</span> l i j default) j i default = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) j i default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) j i default = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkb9"><span class="nb">rewrite</span> swapIndices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> swapTwice; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkba"><span class="kn">Lemma</span> <span class="nf">swapDecomposition</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hLt</span> : i &lt; j) (<span class="nv">hJ</span> : j &lt; length l) : <span class="nb">swap</span> l i j default = take i l ++ [nth j l default] ++ drop (S i) (take j l) ++ [nth i l default] ++ drop (j + <span class="mi">1</span>) l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> l i j default =
take i l ++
[nth j l default] ++
drop (S i) (take j l) ++
[nth i l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkbb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span> l i j default =
take i l ++
[nth j l default] ++
drop (S i) (take j l) ++
[nth i l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkbc"><span class="nb">rewrite</span> (listDecomposition l i j <span class="kp">ltac</span>:(<span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="bp">lia</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkbd"><span class="nb">assert</span> (takeLength : i = length (take i l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkbe"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkbf">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc0"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = i `min` length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc1">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc2"><span class="nb">assert</span> (hRewrite : <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default = <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j
  default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkc3"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc4">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc5"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc6">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j
  default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc7"><span class="nb">rewrite</span> hRewrite.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j
  default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc8"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkc9"><span class="nb">assert</span> (takeLength : j = length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkca"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkcb">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkcc"><span class="nb">rewrite</span> take_length, drop_length, take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkcd"><span class="nb">assert</span> (subtask1 : i `min` length l = i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkce" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkce"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkcf">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd0">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd1"><span class="nb">assert</span> (subtask2 : j `min` length l = j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkd2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkd2"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd4">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd5"><span class="nb">rewrite</span> subtask1, subtask2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i + (j - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd6">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd7"><span class="nb">assert</span> (hRewrite : <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default = <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) (length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) + length (drop (S i) (take j l)) +
   <span class="mi">1</span>) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkd8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) +
   length (drop (S i) (take j l)) + <span class="mi">1</span>)
  default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkd8"><hr></label><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkd9">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) + length (drop (S i) (take j l)) +
   <span class="mi">1</span>) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkda"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkdb">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) +
   length (drop (S i) (take j l)) + <span class="mi">1</span>)
  default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkdc"><span class="nb">rewrite</span> hRewrite, swapApp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) +
   length (drop (S i) (take j l)) + <span class="mi">1</span>)
  default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++
[nth j l default] ++
drop (S i) (take j l) ++
[nth i l default] ++ drop (j + <span class="mi">1</span>) l =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkdd"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++
[nth j l default] ++
drop (S i) (take j l) ++
[nth i l default] ++ drop (j + <span class="mi">1</span>) l =
take i
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) ++
[nth j
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (S i)
  (take j
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)) ++
[nth i
   (take i l ++
    [nth i l default] ++
    drop (S i) (take j l) ++
    [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default] ++
drop (j + <span class="mi">1</span>)
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkde"><span class="nb">rewrite</span> &lt;- (listDecomposition l i j <span class="kp">ltac</span>:(<span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="bp">lia</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++
[nth j l default] ++
drop (S i) (take j l) ++
[nth i l default] ++ drop (j + <span class="mi">1</span>) l =
take i l ++
[nth j l default] ++
drop (S i) (take j l) ++
[nth i l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkdf"><span class="kn">Lemma</span> <span class="nf">nthSwap&#39;</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hWlog</span> : i &lt; j) (<span class="nv">hJ</span> : j &lt; length l) : nth i (<span class="nb">swap</span> l i j default) default = nth j l default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke0"><span class="nb">rewrite</span> (listDecomposition l i j <span class="kp">ltac</span>:(<span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="bp">lia</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke1"><span class="nb">assert</span> (takeLength : i = length (take i l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chke2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chke2"><hr></label><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = length (take i l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke4"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = i `min` length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke5">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke6"><span class="nb">assert</span> (hRewrite : <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default = <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chke7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j
  default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chke7"><hr></label><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke8">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chke9"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkea">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j
  default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j default)
  default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkeb"><span class="nb">rewrite</span> hRewrite.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>i = length (take i l)</span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) i j
  default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkec"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chked"><span class="nb">assert</span> (takeLength : j = length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkee" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkee"><hr></label><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkef">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j =
length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf0"><span class="nb">rewrite</span> take_length, drop_length, take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf1"><span class="nb">assert</span> (subtask1 : i `min` length l = i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkf2"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf4">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf5"><span class="nb">assert</span> (subtask2 : j `min` length l = j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkf6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkf6"><hr></label><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf7">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf8">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i `min` length l + (j `min` length l - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkf9"><span class="nb">rewrite</span> subtask1, subtask2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>j `min` length l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = i + (j - S i) + <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkfa">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkfb"><span class="nb">assert</span> (hRewrite : <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) j default = <span class="nb">swap</span> (take i l ++ [nth i l default] ++ drop (S i) (take j l) ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l) (length (take i l)) (length (take i l) + length (drop (S i) (take j l)) + <span class="mi">1</span>) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) + length (drop (S i) (take j l)) +
   <span class="mi">1</span>) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chkfc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) +
   length (drop (S i) (take j l)) + <span class="mi">1</span>)
  default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chkfc"><hr></label><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkfd">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) + length (drop (S i) (take j l)) +
   <span class="mi">1</span>) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkfe"><span class="nb">rewrite</span> &lt;- <span class="nl">?takeLength</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chkff">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) +
   length (drop (S i) (take j l)) + <span class="mi">1</span>)
  default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (<span class="nb">swap</span>
     (take i l ++
      [nth i l default] ++
      drop (S i) (take j l) ++
      [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
     (length (take i l)) j default) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk100"><span class="nb">rewrite</span> hRewrite, swapApp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>takeLength</var><span class="hyp-type"><b>: </b><span>j =
length (take i l) +
length (drop (S i) (take j l)) + <span class="mi">1</span></span></span></span><br><span><var>hRewrite</var><span class="hyp-type"><b>: </b><span><span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l)) j default =
<span class="nb">swap</span>
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l)
  (length (take i l))
  (length (take i l) +
   length (drop (S i) (take j l)) + <span class="mi">1</span>)
  default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk101"><span class="nb">clear</span> hRewrite takeLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk102"><span class="nb">pose proof</span> nthAppZero (take i l) <span class="kr">as</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth (length (take i l)) (take i l ++ _0) _1 =
  nth <span class="mi">0</span> _0 _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk103"><span class="nb">rewrite</span> take_length <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth (i `min` length l) (take i l ++ _0) _1 =
  nth <span class="mi">0</span> _0 _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk104"><span class="nb">assert</span> (hEqI : i `min` length l = i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth (i `min` length l) (take i l ++ _0) _1 =
  nth <span class="mi">0</span> _0 _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk105" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth (i `min` length l) (take i l ++ _0) _1 =
  nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk105"><hr></label><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk106">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth (i `min` length l) (take i l ++ _0) _1 =
  nth <span class="mi">0</span> _0 _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` length l = i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk107">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth (i `min` length l) (take i l ++ _0) _1 =
  nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk108"><span class="nb">rewrite</span> hEqI <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i
  (take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk109"><span class="nb">rewrite</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth <span class="mi">0</span>
  ([nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l) default =
nth j
  (take i l ++
   [nth i l default] ++
   drop (S i) (take j l) ++
   [nth j l default] ++ drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk10a"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default =
nth j
  (take i l ++
   nth i l default
   :: drop (S i) (take j l) ++
      nth j l default :: drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk10b"><span class="nb">assert</span> (H&#39; : take i l ++ nth i l default :: drop (S i) (take j l) = take j l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++ nth i l default :: drop (S i) (take j l) =
take j l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk10c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk10c"><hr></label><div class="goal-conclusion">nth j l default =
nth j
  (take i l ++
   nth i l default
   :: drop (S i) (take j l) ++
      nth j l default :: drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk10d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++ nth i l default :: drop (S i) (take j l) =
take j l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk10e"><span class="nb">assert</span> (subtask1 : take i l = take i (take j l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l = take i (take j l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk10f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk10f"><hr></label><div class="goal-conclusion">take i l ++ nth i l default :: drop (S i) (take j l) =
take j l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk110">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l = take i (take j l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk111"><span class="nb">rewrite</span> take_take.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l = take (i `min` j) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk112"><span class="nb">assert</span> (hIJ : i `min` j = i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` j = i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk113" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i `min` j = i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk113"><hr></label><div class="goal-conclusion">take i l = take (i `min` j) l</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk114">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i `min` j = i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk115">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i `min` j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l = take (i `min` j) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk116"><span class="nb">rewrite</span> hIJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i `min` j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l = take i l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk117">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i l ++ nth i l default :: drop (S i) (take j l) =
take j l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk118"><span class="nb">rewrite</span> subtask1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (take j l) ++
nth i l default :: drop (S i) (take j l) = 
take j l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk119"><span class="nb">assert</span> (subtask2 : nth i l default = nth i (take j l) default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default = nth i (take j l) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk11a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk11a"><hr></label><div class="goal-conclusion">take i (take j l) ++
nth i l default :: drop (S i) (take j l) = 
take j l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk11b">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default = nth i (take j l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk11c"><span class="nb">apply</span> nthTake.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk11d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (take j l) ++
nth i l default :: drop (S i) (take j l) = 
take j l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk11e"><span class="nb">assert</span> (hNthCons : nth i l default :: drop (S i) (take j l) = drop i (take j l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default :: drop (S i) (take j l) =
drop i (take j l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk11f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>hNthCons</var><span class="hyp-type"><b>: </b><span>nth i l default :: drop (S i) (take j l) =
drop i (take j l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk11f"><hr></label><div class="goal-conclusion">take i (take j l) ++
nth i l default :: drop (S i) (take j l) = 
take j l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk120">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l default :: drop (S i) (take j l) =
drop i (take j l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk121"><span class="nb">rewrite</span> subtask2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (take j l) default :: drop (S i) (take j l) =
drop i (take j l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk122"><span class="nb">apply</span> nthConsDrop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take j l ‚â† []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk123" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk123"><hr></label><div class="goal-conclusion">i &lt; length (take j l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk124">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take j l ‚â† []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk125"><span class="nb">intro</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk126"><span class="nb">assert</span> (hTakeJ : length (take j l) = j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take j l) = j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk127" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk127"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk128">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take j l) = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk129"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j `min` length l = j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk12a">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk12b"><span class="nb">assert</span> (hContradiction : j = <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk12c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br><span><var>hContradiction</var><span class="hyp-type"><b>: </b><span>j = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk12c"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk12d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk12e"><span class="nb">rewrite</span> &lt;- hTakeJ, h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length [] = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk12f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>take j l = []</span></span></span><br><span><var>hTakeJ</var><span class="hyp-type"><b>: </b><span>length (take j l) = j</span></span></span><br><span><var>hContradiction</var><span class="hyp-type"><b>: </b><span>j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk130">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; length (take j l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk131"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; j `min` length l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk132">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>hNthCons</var><span class="hyp-type"><b>: </b><span>nth i l default :: drop (S i) (take j l) =
drop i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (take j l) ++
nth i l default :: drop (S i) (take j l) = 
take j l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk133"><span class="nb">rewrite</span> hNthCons, take_drop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>subtask1</var><span class="hyp-type"><b>: </b><span>take i l = take i (take j l)</span></span></span><br><span><var>subtask2</var><span class="hyp-type"><b>: </b><span>nth i l default = nth i (take j l) default</span></span></span><br><span><var>hNthCons</var><span class="hyp-type"><b>: </b><span>nth i l default :: drop (S i) (take j l) =
drop i (take j l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take j l = take j l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk134">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default =
nth j
  (take i l ++
   nth i l default
   :: drop (S i) (take j l) ++
      nth j l default :: drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk135"><span class="nb">assert</span> (hRebracketing : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span> <span class="nv">e</span> : list A, <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">d</span> : A, a ++ b :: c ++ d :: e = (a ++ b :: c) ++ d :: e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk136" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk136"><hr></label><div class="goal-conclusion">nth j l default =
nth j
  (take i l ++
   nth i l default
   :: drop (S i) (take j l) ++
      nth j l default :: drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk137">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk138"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>_0, _1, _2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3, _4</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_0 ++ _3 :: _1 ++ _4 :: _2 =
(_0 ++ _3 :: _1) ++ _4 :: _2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">listsEqual.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk139">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default =
nth j
  (take i l ++
   nth i l default
   :: drop (S i) (take j l) ++
      nth j l default :: drop (j + <span class="mi">1</span>) l) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk13a"><span class="nb">rewrite</span> hRebracketing, H&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default =
nth j (take j l ++ nth j l default :: drop (j + <span class="mi">1</span>) l)
  default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk13b"><span class="nb">rewrite</span> Nat.add_1_r, nthConsDrop; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default = nth j (take j l ++ drop j l) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk13c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk13c"><hr></label><div class="goal-conclusion">l ‚â† []</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk13d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default = nth j (take j l ++ drop j l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk13e"><span class="nb">rewrite</span> take_drop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk13f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â† []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk140"><span class="nb">intro</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i l ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length l = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i l ++
nth i l default :: drop (S i) (take j l) =
take j l</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk141"><span class="nb">rewrite</span> h <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length []</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i [] ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` length [] = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i [] ++
nth i [] default :: drop (S i) (take j []) =
take j []</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk142"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; <span class="mi">0</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : A),
  nth i (take i [] ++ _0) _1 = nth <span class="mi">0</span> _0 _1</span></span></span><br><span><var>hEqI</var><span class="hyp-type"><b>: </b><span>i `min` <span class="mi">0</span> = i</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>take i [] ++
<span class="kr">match</span> i <span class="kr">with</span>
| <span class="mi">0</span> | _ =&gt; default
<span class="kr">end</span> :: drop (S i) (take j []) = 
take j []</span></span></span><br><span><var>hRebracketing</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> <span class="nv">_1</span> <span class="nv">_2</span> : list A) (<span class="nv">_3</span> <span class="nv">_4</span> : A),
  _0 ++ _3 :: _1 ++ _4 :: _2 =
  (_0 ++ _3 :: _1) ++ _4 :: _2</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>l = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk143"><span class="kn">Lemma</span> <span class="nf">nthSwap</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hI</span> : i &lt; length l) (<span class="nv">hJ</span> : j &lt; length l) : nth i (<span class="nb">swap</span> l i j default) default = nth j l default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk144"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk145"><span class="nb">assert</span> (hWlog : i = j \/ i &lt; j \/ j &lt; i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = j ‚à® i &lt; j ‚à® j &lt; i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk146" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j ‚à® i &lt; j ‚à® j &lt; i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk146"><hr></label><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk147">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = j ‚à® i &lt; j ‚à® j &lt; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk148">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j ‚à® i &lt; j ‚à® j &lt; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk149"><span class="nb">destruct</span> hWlog <span class="kr">as</span> [hWlog | [hWlog | hWlog]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk14a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk14a"><hr></label><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk14b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk14b"><hr></label><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk14c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk14d"><span class="nb">rewrite</span> hWlog, swapSelf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk14e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> nthSwap&#39;; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk14f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk150"><span class="nb">pose proof</span> nthSwap&#39; (<span class="nb">swap</span> l i j default) default j i <span class="kr">as</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>j &lt; i
‚Üí i &lt; length (<span class="nb">swap</span> l i j default)
  ‚Üí nth j (<span class="nb">swap</span> (<span class="nb">swap</span> l i j default) j i default)
      default = nth i (<span class="nb">swap</span> l i j default) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk151"><span class="nb">rewrite</span> swapPreservesLength, swapIndices <span class="kr">in</span> H; <span class="nb">rewrite</span> <span class="nl">?swapPreservesLength</span>; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>j &lt; i
‚Üí i &lt; length l
  ‚Üí nth j (<span class="nb">swap</span> (<span class="nb">swap</span> l i j default) i j default)
      default = nth i (<span class="nb">swap</span> l i j default) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk152"><span class="nb">rewrite</span> swapTwice <span class="kr">in</span> H; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>j &lt; i
‚Üí i &lt; length l
  ‚Üí nth j l default =
    nth i (<span class="nb">swap</span> l i j default) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk153"><span class="nb">rewrite</span> H; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hWlog</var><span class="hyp-type"><b>: </b><span>j &lt; i</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>j &lt; i
‚Üí i &lt; length l
  ‚Üí nth j l default =
    nth i (<span class="nb">swap</span> l i j default) default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l i j default) default =
nth i (<span class="nb">swap</span> l i j default) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk154"><span class="kn">Lemma</span> <span class="nf">nthSwapVariant</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hI</span> : i &lt; length l) (<span class="nv">hJ</span> : j &lt; length l) : nth i (<span class="nb">swap</span> l j i default) default = nth j l default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l j i default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk155"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (<span class="nb">swap</span> l j i default) default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk156"><span class="nb">rewrite</span> swapIndices, nthSwap; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth j l default = nth j l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk157"><span class="kn">Lemma</span> <span class="nf">nthUpdate</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> : nat) (<span class="nv">value</span> : A) (<span class="nv">hLt</span> : i &lt; length l) : nth i (&lt;[i := value]&gt; l) default = value.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (&lt;[i:=value]&gt; l) default = value</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk158"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (&lt;[i:=value]&gt; l) default = value</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">revert</span> hLt; <span class="nb">revert</span> i; <span class="nb">induction</span> l <span class="kr">as</span> [| head l IHl]; <span class="nb">intros</span> i hLt; <span class="nb">unfold</span> alter; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span>; <span class="nb">unfold</span> alter <span class="kr">in</span> IHl; <span class="nb">destruct</span> i; <span class="nb">simpl</span>; <span class="nb">rewrite</span> <span class="nl">?IHl</span>; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="bp">lia</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk159"><span class="kn">Lemma</span> <span class="nf">nthUpdateExcept</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">uninvolved</span> : nat) (<span class="nv">value</span> : A) (<span class="nv">hLt</span> : i &lt; length l) (<span class="nv">hUninvolved</span> : uninvolved &lt;&gt; i) : nth uninvolved (&lt;[i := value]&gt; l) default = nth uninvolved l default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (&lt;[i:=value]&gt; l) default =
nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk15a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (&lt;[i:=value]&gt; l) default =
nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk15b"><span class="nb">revert</span> hLt; <span class="nb">revert</span> hUninvolved; <span class="nb">revert</span> i uninvolved; <span class="nb">induction</span> l <span class="kr">as</span> [| head l IHl]; <span class="nb">intros</span> i uninvolved hUninvolved hLt; <span class="nb">unfold</span> alter; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">unfold</span> alter <span class="kr">in</span> IHl; <span class="nb">destruct</span> i; <span class="nb">rewrite</span> <span class="nl">?IHl</span>; <span class="nb">simpl</span> <span class="kr">in</span> hLt; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† <span class="mi">0</span></span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (&lt;[<span class="mi">0</span>:=value]&gt; (head :: l)) default =
nth uninvolved (head :: l) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk15c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>_0, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† S _0</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S _0 &lt; S (length l)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk15c"><hr></label><div class="goal-conclusion">nth uninvolved (&lt;[S _0:=value]&gt; (head :: l)) default =
nth uninvolved (head :: l) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk15d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† <span class="mi">0</span></span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (&lt;[<span class="mi">0</span>:=value]&gt; (head :: l)) default =
nth uninvolved (head :: l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk15e"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† <span class="mi">0</span></span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> uninvolved <span class="kr">with</span>
| <span class="mi">0</span> =&gt; value
| S _0 =&gt; nth _0 l default
<span class="kr">end</span> =
<span class="kr">match</span> uninvolved <span class="kr">with</span>
| <span class="mi">0</span> =&gt; head
| S _0 =&gt; nth _0 l default
<span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> uninvolved; <span class="kp">try</span> <span class="bp">lia</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk15f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>_0, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† S _0</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S _0 &lt; S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (&lt;[S _0:=value]&gt; (head :: l)) default =
nth uninvolved (head :: l) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk160"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>_0, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† S _0</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S _0 &lt; S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> uninvolved <span class="kr">with</span>
| <span class="mi">0</span> =&gt; head
| S _1 =&gt; nth _1 (&lt;[_0:=value]&gt; l) default
<span class="kr">end</span> =
<span class="kr">match</span> uninvolved <span class="kr">with</span>
| <span class="mi">0</span> =&gt; head
| S _0 =&gt; nth _0 l default
<span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk161"><span class="nb">destruct</span> uninvolved; <span class="kp">try</span> <span class="bp">lia</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default, value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _1 ‚â† _0
  ‚Üí _0 &lt; length l
    ‚Üí nth _1 (&lt;[_0:=value]&gt; l) default =
      nth _1 l default</span></span></span><br><span><var>_0, _1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hUninvolved</var><span class="hyp-type"><b>: </b><span>S _1 ‚â† S _0</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>S _0 &lt; S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth _1 (&lt;[_0:=value]&gt; l) default = nth _1 l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk162"><span class="kn">Lemma</span> <span class="nf">nthSwapExcept</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> <span class="nv">uninvolved</span> : nat) (<span class="nv">hI</span> : i &lt; length l) (<span class="nv">hJ</span> : j &lt; length l) (<span class="nv">hUninvolvedI</span> : uninvolved &lt;&gt; i) (<span class="nv">hUninvolvedJ</span> : uninvolved &lt;&gt; j) : nth uninvolved (<span class="nb">swap</span> l i j default) default = nth uninvolved l default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hUninvolvedI</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br><span><var>hUninvolvedJ</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (<span class="nb">swap</span> l i j default) default =
nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk163"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hUninvolvedI</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br><span><var>hUninvolvedJ</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (<span class="nb">swap</span> l i j default) default =
nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk164"><span class="nb">unfold</span> <span class="nb">swap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hUninvolvedI</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br><span><var>hUninvolvedJ</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved
  (&lt;[j:=nth i l default]&gt; (&lt;[i:=nth j l default]&gt; l))
  default = nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> <span class="nl">?nthUpdateExcept</span>; <span class="nb">rewrite</span> <span class="nl">?insert_length</span>; <span class="kp">try</span> <span class="bp">lia</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk165"><span class="kn">Lemma</span> <span class="nf">nthSwapExceptVariant</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l</span> : list A) (<span class="nv">default</span> : A) (<span class="nv">i</span> <span class="nv">j</span> <span class="nv">uninvolved</span> : nat) (<span class="nv">hI</span> : i &lt; length l) (<span class="nv">hJ</span> : j &lt; length l) (<span class="nv">hUninvolvedI</span> : uninvolved &lt;&gt; i) (<span class="nv">hUninvolvedJ</span> : uninvolved &lt;&gt; j) : nth uninvolved (<span class="nb">swap</span> l j i default) default = nth uninvolved l default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hUninvolvedI</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br><span><var>hUninvolvedJ</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (<span class="nb">swap</span> l j i default) default =
nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk166"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hUninvolvedI</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br><span><var>hUninvolvedJ</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved (<span class="nb">swap</span> l j i default) default =
nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk167"><span class="nb">rewrite</span> swapIndices, nthSwapExcept; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j, uninvolved</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hUninvolvedI</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† i</span></span></span><br><span><var>hUninvolvedJ</var><span class="hyp-type"><b>: </b><span>uninvolved ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth uninvolved l default = nth uninvolved l default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk168"><span class="kn">Lemma</span> <span class="nf">oneDifferentPlace</span> {<span class="nv">A</span> : <span class="kt">Type</span>} `{EqDecision A} (l1 l2 : list A) (default : A) (hDiff : l1 &lt;&gt; l2) (hSameLength : length l1 = length l2) : <span class="kr">exists</span> <span class="nv">i</span>, i &lt; length l1 /\ nth i l1 default &lt;&gt; nth i l2 default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>l1 ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length l1
  ‚àß nth _0 l1 default ‚â† nth _0 l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk169"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>l1 ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length l1
  ‚àß nth _0 l1 default ‚â† nth _0 l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk16a"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> l2, hDiff, hSameLength |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>[] ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length [] = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length []
  ‚àß nth _0 [] default ‚â† nth _0 l2 default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk16b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) = length l2</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk16b"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default ‚â† nth _0 l2 default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk16c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>[] ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length [] = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length []
  ‚àß nth _0 [] default ‚â† nth _0 l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk16d"><span class="nb">simpl</span> <span class="kr">in</span> hSameLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>[] ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length []
  ‚àß nth _0 [] default ‚â† nth _0 l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk16e"><span class="nb">pose proof</span> nil_length_inv _ (eq_sym hSameLength).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>[] ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> = length l2</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>l2 = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length []
  ‚àß nth _0 [] default ‚â† nth _0 l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk16f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† l2</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) = length l2</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default ‚â† nth _0 l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk170"><span class="nb">destruct</span> l2 <span class="kr">as</span> [| head1 tail1]; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk171"><span class="nb">remember</span> (bool_decide (head = head1)) <span class="kr">as</span> <span class="nb">split</span> <span class="nb">eqn</span>:hSplit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>split</var><span class="hyp-type"><b>: </b><span>bool</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span><span class="nb">split</span> = bool_decide (head = head1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk172"><span class="nb">destruct</span> <span class="nb">split</span>; <span class="nb">symmetry in</span> hSplit; <span class="nb">rewrite</span> &lt;- <span class="nl">?Is_true_true</span>, &lt;- <span class="nl">?Is_true_false</span>, bool_decide_spec <span class="kr">in</span> hSplit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head = head1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk173" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head ‚â† head1</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk173"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk174">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head = head1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk175"><span class="nb">rewrite</span> hSplit <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head1 :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head = head1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head1 :: tail)
  ‚àß nth _0 (head1 :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk176"><span class="nb">destruct</span> (IH tail1 <span class="kp">ltac</span>:(<span class="bp">congruence</span>) <span class="kp">ltac</span>:(<span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">lia</span>)) <span class="kr">as</span> [w h].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head1 :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head = head1</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>w &lt; length tail
‚àß nth w tail default ‚â† nth w tail1 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head1 :: tail)
  ‚àß nth _0 (head1 :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk177"><span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">w</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head1 :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head = head1</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>w &lt; length tail
‚àß nth w tail default ‚â† nth w tail1 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S w &lt; length (head1 :: tail)
‚àß nth (S w) (head1 :: tail) default
  ‚â† nth (S w) (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk178"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head1 :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head = head1</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>w &lt; length tail
‚àß nth w tail default ‚â† nth w tail1 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S w &lt; S (length tail)
‚àß nth w tail default ‚â† nth w tail1 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; (<span class="bp">lia</span> || <span class="bp">easy</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk179">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head ‚â† head1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length (head :: tail)
  ‚àß nth _0 (head :: tail) default
    ‚â† nth _0 (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17a"><span class="kr">exists</span> <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head ‚â† head1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; length (head :: tail)
‚àß nth <span class="mi">0</span> (head :: tail) default
  ‚â† nth <span class="mi">0</span> (head1 :: tail1) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>hDiff</var><span class="hyp-type"><b>: </b><span>head :: tail ‚â† head1 :: tail1</span></span></span><br><span><var>hSameLength</var><span class="hyp-type"><b>: </b><span>length (head :: tail) =
length (head1 :: tail1)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  tail ‚â† _0
  ‚Üí length tail = length _0
    ‚Üí <span class="kr">‚àÉ</span> <span class="nv">_1</span> : nat,
        _1 &lt; length tail
        ‚àß nth _1 tail default ‚â† nth _1 _0 default</span></span></span><br><span><var>hSplit</var><span class="hyp-type"><b>: </b><span>head ‚â† head1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S (length tail) ‚àß head ‚â† head1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; (<span class="bp">lia</span> || <span class="bp">easy</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17c"><span class="kn">Lemma</span> <span class="nf">takeAppLt</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">i</span> : nat) (<span class="nv">hI</span> : i &lt;= length l1) : take i (l1 ++ l2) = take i l1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ length l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (l1 ++ l2) = take i l1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ length l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (l1 ++ l2) = take i l1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17e"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> i, hI |- *; <span class="nb">simpl</span> <span class="kr">in</span> *;
  <span class="kp">try</span> (<span class="nb">rewrite</span> (<span class="kp">ltac</span>:(<span class="bp">lia</span>) : i = <span class="mi">0</span>) <span class="kr">in</span> *; <span class="bp">easy</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 ‚â§ length tail
  ‚Üí take _0 (tail ++ l2) = take _0 tail</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (head :: tail ++ l2) = take i (head :: tail)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk17f"><span class="nb">destruct</span> i; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 ‚â§ length tail
  ‚Üí take _0 (tail ++ l2) = take _0 tail</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take (S _0) (head :: tail ++ l2) =
take (S _0) (head :: tail)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk180"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 ‚â§ length tail
  ‚Üí take _0 (tail ++ l2) = take _0 tail</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">head :: take _0 (tail ++ l2) = head :: take _0 tail</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IH; (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk181"><span class="kn">Lemma</span> <span class="nf">takeRepeat</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">x</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hIJ</span> : i &lt;= j) : take i (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk182"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take i (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk183"><span class="nb">induction</span> i <span class="kr">as</span> [| i IH] <span class="kr">in</span> j, hIJ |- *; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>S i ‚â§ j</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  i ‚â§ _0 ‚Üí take i (<span class="kp">repeat</span> x _0) = <span class="kp">repeat</span> x i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">take (S i) (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (S i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> j; <span class="nb">simpl</span>; <span class="nb">rewrite</span> <span class="nl">?IH</span>; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk184"><span class="kn">Lemma</span> <span class="nf">dropApp</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">i</span> : nat) (<span class="nv">hI</span> : i &lt;= length l1) : drop i (l1 ++ l2) = drop i l1 ++ l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ length l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i (l1 ++ l2) = drop i l1 ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk185"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ length l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i (l1 ++ l2) = drop i l1 ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk186"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> i, hI, l2 |- *; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i l2 = drop i [] ++ l2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk187" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk187"><hr></label><div class="goal-conclusion">drop i (head :: tail ++ l2) =
drop i (head :: tail) ++ l2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk188">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i l2 = drop i [] ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (<span class="kp">ltac</span>:(<span class="bp">lia</span>) : i = <span class="mi">0</span>), drop_0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk189">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i (head :: tail ++ l2) =
drop i (head :: tail) ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk18a"><span class="nb">destruct</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop <span class="mi">0</span> (head :: tail ++ l2) =
drop <span class="mi">0</span> (head :: tail) ++ l2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk18b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk18b"><hr></label><div class="goal-conclusion">drop (S _0) (head :: tail ++ l2) =
drop (S _0) (head :: tail) ++ l2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk18c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop <span class="mi">0</span> (head :: tail ++ l2) =
drop <span class="mi">0</span> (head :: tail) ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> drop_0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk18d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop (S _0) (head :: tail ++ l2) =
drop (S _0) (head :: tail) ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk18e"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 ‚â§ S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list A) (<span class="nv">_1</span> : nat),
  _1 ‚â§ length tail
  ‚Üí drop _1 (tail ++ _0) = drop _1 tail ++ _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop _0 (tail ++ l2) = drop _0 tail ++ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IH; (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk18f"><span class="kn">Lemma</span> <span class="nf">dropRepeat</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">x</span> : A) (<span class="nv">i</span> <span class="nv">j</span> : nat) : drop i (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk190"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk191"><span class="nb">induction</span> i <span class="kr">as</span> [| i IH] <span class="kr">in</span> j |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop <span class="mi">0</span> (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk192" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  drop i (<span class="kp">repeat</span> x _0) = <span class="kp">repeat</span> x (_0 - i)</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk192"><hr></label><div class="goal-conclusion">drop (S i) (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - S i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk193">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop <span class="mi">0</span> (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> Nat.sub_0_r, drop_0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk194">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  drop i (<span class="kp">repeat</span> x _0) = <span class="kp">repeat</span> x (_0 - i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop (S i) (<span class="kp">repeat</span> x j) = <span class="kp">repeat</span> x (j - S i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk195"><span class="nb">destruct</span> j; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, _0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  drop i (<span class="kp">repeat</span> x _0) = <span class="kp">repeat</span> x (_0 - i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop (S i) (<span class="kp">repeat</span> x (S _0)) = <span class="kp">repeat</span> x (S _0 - S i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk196"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>i, _0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  drop i (<span class="kp">repeat</span> x _0) = <span class="kp">repeat</span> x (_0 - i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">drop i (<span class="kp">repeat</span> x _0) = <span class="kp">repeat</span> x (_0 - i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> IH.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk197"><span class="kn">Lemma</span> <span class="nf">nthAppLt</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">default</span> : A) (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">i</span> : nat) (<span class="nv">hI</span> : i &lt; length l1) : nth i (l1 ++ l2) default = nth i l1 default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (l1 ++ l2) default = nth i l1 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk198"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (l1 ++ l2) default = nth i l1 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk199"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> i, hI |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i ([] ++ l2) default = nth i [] default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk19a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length (head :: tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length tail
  ‚Üí nth _0 (tail ++ l2) default =
    nth _0 tail default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk19a"><hr></label><div class="goal-conclusion">nth i ((head :: tail) ++ l2) default =
nth i (head :: tail) default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk19b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i ([] ++ l2) default = nth i [] default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk19c"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l2 default = <span class="kr">match</span> i <span class="kr">with</span>
                   | <span class="mi">0</span> | _ =&gt; default
                   <span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk19d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>i &lt; length (head :: tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length tail
  ‚Üí nth _0 (tail ++ l2) default =
    nth _0 tail default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i ((head :: tail) ++ l2) default =
nth i (head :: tail) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk19e"><span class="nb">destruct</span> i; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 &lt; length (head :: tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length tail
  ‚Üí nth _0 (tail ++ l2) default =
    nth _0 tail default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (S _0) ((head :: tail) ++ l2) default =
nth (S _0) (head :: tail) default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk19f"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S _0 &lt; S (length tail)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; length tail
  ‚Üí nth _0 (tail ++ l2) default =
    nth _0 tail default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth _0 (tail ++ l2) default = nth _0 tail default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IH; (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a0"><span class="kn">Lemma</span> <span class="nf">nthAppGeq</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">default</span> : A) (<span class="nv">l1</span> <span class="nv">l2</span> : list A) (<span class="nv">i</span> : nat) (<span class="nv">hI</span> : length l1 &lt;= i) : nth i (l1 ++ l2) default = nth (i - length l1) l2 default.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length l1 ‚â§ i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (l1 ++ l2) default =
nth (i - length l1) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length l1 ‚â§ i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i (l1 ++ l2) default =
nth (i - length l1) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a2"><span class="nb">induction</span> l1 <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> i, hI |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length [] ‚â§ i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i ([] ++ l2) default =
nth (i - length []) l2 default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk1a3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length (head :: tail) ‚â§ i</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  length tail ‚â§ _0
  ‚Üí nth _0 (tail ++ l2) default =
    nth (_0 - length tail) l2 default</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk1a3"><hr></label><div class="goal-conclusion">nth i ((head :: tail) ++ l2) default =
nth (i - length (head :: tail)) l2 default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length [] ‚â§ i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i ([] ++ l2) default =
nth (i - length []) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a5"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ‚â§ i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i l2 default = nth (i - <span class="mi">0</span>) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> Nat.sub_0_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length (head :: tail) ‚â§ i</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  length tail ‚â§ _0
  ‚Üí nth _0 (tail ++ l2) default =
    nth (_0 - length tail) l2 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth i ((head :: tail) ++ l2) default =
nth (i - length (head :: tail)) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a7"><span class="nb">destruct</span> i; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>length (head :: tail) ‚â§ S _0</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  length tail ‚â§ _0
  ‚Üí nth _0 (tail ++ l2) default =
    nth (_0 - length tail) l2 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (S _0) ((head :: tail) ++ l2) default =
nth (S _0 - length (head :: tail)) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a8"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default, head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>S (length tail) ‚â§ S _0</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  length tail ‚â§ _0
  ‚Üí nth _0 (tail ++ l2) default =
    nth (_0 - length tail) l2 default</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth _0 (tail ++ l2) default =
nth (_0 - length tail) l2 default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IH; (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1a9"><span class="kn">Lemma</span> <span class="nf">swapPermutation</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">default</span> : A) (<span class="nv">l</span> : list A) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hIJ</span> : i &lt;= j) (<span class="nv">hJ</span> : j &lt; length l) : Permutation l (<span class="nb">swap</span> l i j default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1aa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i j default</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1ab"><span class="nb">destruct</span> (decide (i = j)) <span class="kr">as</span> [hCase | hCase].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i j default</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk1ac" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk1ac"><hr></label><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i j default</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1ad">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1ae"><span class="nb">subst</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>i &lt; length l</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i i default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> swapSelf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1af">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö <span class="nb">swap</span> l i j default</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b0"><span class="nb">rewrite</span> (swapDecomposition l default i j <span class="kp">ltac</span>:(<span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="bp">lia</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l
‚â°‚Çö take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b1"><span class="nb">pose proof</span> listDecomposition l i j <span class="kp">ltac</span>:(<span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="bp">lia</span>) default <span class="kr">as</span> reduce.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l =
take i l ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l
‚â°‚Çö take i l ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b2"><span class="nb">remember</span> (take i l) <span class="kr">as</span> F.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l =
F ++
[nth i l default] ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l
‚â°‚Çö F ++
   [nth j l default] ++
   drop (S i) (take j l) ++
   [nth i l default] ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b3"><span class="nb">remember</span> [nth i l default] <span class="kr">as</span> B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l =
F ++
B ++
drop (S i) (take j l) ++
[nth j l default] ++ drop (j + <span class="mi">1</span>) l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l
‚â°‚Çö F ++
   [nth j l default] ++
   drop (S i) (take j l) ++ B ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b4"><span class="nb">remember</span> (drop (S i) (take j l)) <span class="kr">as</span> C.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l =
F ++
B ++ C ++ [nth j l default] ++ drop (j + <span class="mi">1</span>) l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l
‚â°‚Çö F ++ [nth j l default] ++ C ++ B ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b5"><span class="nb">remember</span> [nth j l default] <span class="kr">as</span> D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ drop (j + <span class="mi">1</span>) l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö F ++ D ++ C ++ B ++ drop (j + <span class="mi">1</span>) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b6"><span class="nb">remember</span> (drop (j + <span class="mi">1</span>) l) <span class="kr">as</span> E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_4</var><span class="hyp-type"><b>: </b><span>E = drop (j + <span class="mi">1</span>) l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l ‚â°‚Çö F ++ D ++ C ++ B ++ E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b7"><span class="nb">rewrite</span> reduce.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_4</var><span class="hyp-type"><b>: </b><span>E = drop (j + <span class="mi">1</span>) l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F ++ B ++ C ++ D ++ E ‚â°‚Çö F ++ D ++ C ++ B ++ E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1b8"><span class="nb">assert</span> (hI : Permutation (B ++ C ++ D) (D ++ C ++ B)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_4</var><span class="hyp-type"><b>: </b><span>E = drop (j + <span class="mi">1</span>) l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B ++ C ++ D ‚â°‚Çö D ++ C ++ B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="SwapUpdate-v-chk1b9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_4</var><span class="hyp-type"><b>: </b><span>E = drop (j + <span class="mi">1</span>) l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ E</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>B ++ C ++ D ‚â°‚Çö D ++ C ++ B</span></span></span><br></div><label class="goal-separator" for="SwapUpdate-v-chk1b9"><hr></label><div class="goal-conclusion">F ++ B ++ C ++ D ++ E ‚â°‚Çö F ++ D ++ C ++ B ++ E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1ba">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_4</var><span class="hyp-type"><b>: </b><span>E = drop (j + <span class="mi">1</span>) l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B ++ C ++ D ‚â°‚Çö D ++ C ++ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (Permutation_app_comm C B), (app_assoc D B C), (Permutation_app_comm D B), &lt;- !app_assoc, (Permutation_app_comm D C).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="SwapUpdate-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="SwapUpdate-v-chk1bb">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hIJ</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hJ</var><span class="hyp-type"><b>: </b><span>j &lt; length l</span></span></span><br><span><var>hCase</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>F = take i l</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>B = [nth i l default]</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>C = drop (S i) (take j l)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_3</var><span class="hyp-type"><b>: </b><span>D = [nth j l default]</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_4</var><span class="hyp-type"><b>: </b><span>E = drop (j + <span class="mi">1</span>) l</span></span></span><br><span><var>reduce</var><span class="hyp-type"><b>: </b><span>l = F ++ B ++ C ++ D ++ E</span></span></span><br><span><var>hI</var><span class="hyp-type"><b>: </b><span>B ++ C ++ D ‚â°‚Çö D ++ C ++ B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F ++ B ++ C ++ D ++ E ‚â°‚Çö F ++ D ++ C ++ B ++ E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (<span class="kp">ltac</span>:(listsEqual) : F ++ D ++ C ++ B ++ E = F ++ (D ++ C ++ B) ++ E), &lt;- hI, &lt;- !app_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span></pre>
    </article>
  </body>
</html>
