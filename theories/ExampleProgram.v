From CoqCP Require Import Options Imperative.
From stdpp Require Import numbers list strings.
Require Import Coq.Strings.Ascii.
Open Scope type_scope.
Definition environment0 : Environment := {| arrayType := fun name => if decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) then Z else False; arrays := fun name => ltac:(destruct (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; exact []) |}.
#[export] Instance arrayTypeEqualityDecidable0 (name : string) : EqDecision (arrayType environment0 name).
Proof. simpl. repeat destruct (decide _). all: solve_decision. Defined.
Definition funcdef_0_ReadUnsignedInt64_ (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment0)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind (bind (bind ((bind (Done _ _ _ 0%Z) (fun x => numberLocalSet (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (EmptyString))))))) x))) (fun ignored => (bind (Done _ _ _ 20%Z) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment0)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind (bind (bind ((liftToWithinLoop (bind (readChar (arrayType environment0)) (fun x => numberLocalSet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString)))))))) x)))) (fun ignored => (bind (liftToWithinLoop (shortCircuitOr (bind (numberLocalGet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (fun a => bind (Done _ _ _ 48%Z) (fun b => Done _ _ _ (bool_decide (Z.lt a b))))) (bind (bind (numberLocalGet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (fun a => bind (Done _ _ _ 58%Z) (fun b => Done _ _ _ (bool_decide (Z.lt a b))))) (fun x => Done _ _ _ (negb x))))) (fun x => if x then (continue (arrayType environment0)) else Done _ _ _ tt)))) (fun ignored => (liftToWithinLoop (bind (addInt64 (multInt64 (numberLocalGet (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (EmptyString)))))))) (Done _ _ _ 10%Z)) (subInt64 (numberLocalGet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (Done _ _ _ 48%Z))) (fun x => numberLocalSet (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (EmptyString))))))) x))))) (fun ignored => (break (arrayType environment0)))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => (bind (Done _ _ _ 20%Z) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment0)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind (bind ((liftToWithinLoop (bind (readChar (arrayType environment0)) (fun x => numberLocalSet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString)))))))) x)))) (fun ignored => (bind (liftToWithinLoop (shortCircuitOr (bind (numberLocalGet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (fun a => bind (Done _ _ _ 48%Z) (fun b => Done _ _ _ (bool_decide (Z.lt a b))))) (bind (bind (numberLocalGet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (fun a => bind (Done _ _ _ 58%Z) (fun b => Done _ _ _ (bool_decide (Z.lt a b))))) (fun x => Done _ _ _ (negb x))))) (fun x => if x then (break (arrayType environment0)) else Done _ _ _ tt)))) (fun ignored => (liftToWithinLoop (bind (addInt64 (multInt64 (numberLocalGet (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (EmptyString)))))))) (Done _ _ _ 10%Z)) (subInt64 (numberLocalGet (arrayType environment0) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (Done _ _ _ 48%Z))) (fun x => numberLocalSet (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (EmptyString))))))) x))))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (numberLocalGet (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (EmptyString)))))))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment0) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => Done _ _ _ tt)).
Definition environment1 : Environment := {| arrayType := fun name => if decide (name = String "098" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString))))))) then Z else False; arrays := fun name => ltac:(destruct (decide (name = String "098" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString)))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 20)) |]; exact []) |}.
#[export] Instance arrayTypeEqualityDecidable1 (name : string) : EqDecision (arrayType environment1 name).
Proof. simpl. repeat destruct (decide _). all: solve_decision. Defined.
Definition funcdef_0_PrintInt64_unsigned (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment1)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind ((bind (bind (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (fun x => bind (Done _ _ _ 0%Z) (fun y => Done _ _ _ (bool_decide (x = y))))) (fun x => if x then (bind (bind (Done _ _ _ 48%Z) (fun x => Done _ _ _ (coerceInt8 x))) (fun x => writeChar (arrayType environment1) x)) else bind (bind ((bind (Done _ _ _ 0%Z) (fun x => numberLocalSet (arrayType environment1) (String "105" (EmptyString)) x))) (fun ignored => (bind (Done _ _ _ 20%Z) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment1)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind (bind (bind (bind ((bind (liftToWithinLoop (bind (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (fun x => bind (Done _ _ _ 0%Z) (fun y => Done _ _ _ (bool_decide (x = y)))))) (fun x => if x then (break (arrayType environment1)) else Done _ _ _ tt))) (fun ignored => (liftToWithinLoop (bind (bind (addInt64 (modIntUnsigned (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (Done _ _ _ 10%Z)) (Done _ _ _ 48%Z)) (fun x => Done _ _ _ (coerceInt8 x))) (fun x => numberLocalSet (arrayType environment1) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString)))))))) x))))) (fun ignored => (liftToWithinLoop (bind (numberLocalGet (arrayType environment1) (String "105" (EmptyString))) (fun x => bind (bind (numberLocalGet (arrayType environment1) (String "116" (String "109" (String "112" (String "067" (String "104" (String "097" (String "114" (EmptyString))))))))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment1) (String "098" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (liftToWithinLoop (bind (divIntUnsigned (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (Done _ _ _ 10%Z)) (fun x => numberLocalSet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString)))) x))))) (fun ignored => (liftToWithinLoop (bind (addInt64 (numberLocalGet (arrayType environment1) (String "105" (EmptyString))) (Done _ _ _ 1%Z)) (fun x => numberLocalSet (arrayType environment1) (String "105" (EmptyString)) x))))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => (bind (numberLocalGet (arrayType environment1) (String "105" (EmptyString))) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment1)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind ((liftToWithinLoop (bind (let x := bind (subInt64 (subInt64 (numberLocalGet (arrayType environment1) (String "105" (EmptyString))) binder_0) (Done _ _ _ 1%Z)) (fun x => retrieve (arrayType environment1) (String "098" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString))))))) x) in ltac:(simpl in *; exact x)) (fun x => writeChar (arrayType environment1) x)))) (fun ignored => Done _ _ _ tt))))))))) (fun ignored => Done _ _ _ tt)).
Definition funcdef_0_PrintInt64_signed (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment1)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind ((bind (bind (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (fun a => bind (Done _ _ _ 0%Z) (fun b => Done _ _ _ (bool_decide (Z.lt (toSigned64 a) (toSigned64 b)))))) (fun x => if x then bind ((bind (bind (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (fun x => Done _ _ _ (-x))) (fun x => numberLocalSet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString)))) x))) (fun ignored => (bind (bind (Done _ _ _ 45%Z) (fun x => Done _ _ _ (coerceInt8 x))) (fun x => writeChar (arrayType environment1) x))) else Done _ _ _ tt))) (fun ignored => (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (numberLocalGet (arrayType environment1) (String "110" (String "117" (String "109" (EmptyString))))) (fun y => Done _ _ _ (update x (String "110" (String "117" (String "109" (EmptyString)))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0_PrintInt64_unsigned y x)))))) (fun ignored => Done _ _ _ tt)).
Definition environment2 : Environment := {| arrayType := fun name => if decide (name = String "102" (String "101" (String "110" (String "119" (String "105" (String "099" (String "107" (EmptyString)))))))) then Z else if decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) then Z else if decide (name = String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) then Z else if decide (name = String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) then Z else if decide (name = String "118" (String "097" (String "108" (String "117" (String "101" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) then Z else if decide (name = String "115" (String "117" (String "109" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) then Z else if decide (name = String "112" (String "114" (String "105" (String "110" (String "116" (String "066" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString)))))))))))) then Z else if decide (name = String "110" (EmptyString)) then Z else if decide (name = String "113" (EmptyString)) then Z else False; arrays := fun name => ltac:(destruct (decide (name = String "102" (String "101" (String "110" (String "119" (String "105" (String "099" (String "107" (EmptyString))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 200001)) |]; destruct (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; destruct (decide (name = String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; destruct (decide (name = String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; destruct (decide (name = String "118" (String "097" (String "108" (String "117" (String "101" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; destruct (decide (name = String "115" (String "117" (String "109" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; destruct (decide (name = String "112" (String "114" (String "105" (String "110" (String "116" (String "066" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString))))))))))))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 20)) |]; destruct (decide (name = String "110" (EmptyString))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; destruct (decide (name = String "113" (EmptyString))) as [h |]; [(rewrite h; simpl; exact (repeat (0%Z) 1)) |]; exact []) |}.
#[export] Instance arrayTypeEqualityDecidable2 (name : string) : EqDecision (arrayType environment2 name).
Proof. simpl. repeat destruct (decide _). all: solve_decision. Defined.
Definition funcdef_0__increase (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment2)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind (bind ((bind (Done _ _ _ 0%Z) (fun x => bind (bind (addInt64 (numberLocalGet (arrayType environment2) (String "105" (String "100" (String "120" (EmptyString))))) (Done _ _ _ 1%Z)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (numberLocalGet (arrayType environment2) (String "118" (String "097" (String "108" (String "117" (String "101" (EmptyString))))))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "118" (String "097" (String "108" (String "117" (String "101" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (Done _ _ _ 30%Z) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment2)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind (bind ((bind (liftToWithinLoop (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "110" (EmptyString)) x) in ltac:(simpl in *; exact x)) (fun a => bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun b => Done _ _ _ (bool_decide (Z.lt a b)))))) (fun x => if x then (break (arrayType environment2)) else Done _ _ _ tt))) (fun ignored => (liftToWithinLoop (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun x => bind (bind (addInt64 (let x := bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun x => retrieve (arrayType environment2) (String "102" (String "101" (String "110" (String "119" (String "105" (String "099" (String "107" (EmptyString)))))))) x) in ltac:(simpl in *; exact x)) (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "118" (String "097" (String "108" (String "117" (String "101" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) x) in ltac:(simpl in *; exact x))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "102" (String "101" (String "110" (String "119" (String "105" (String "099" (String "107" (EmptyString)))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (addInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (andBits (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun x => Done _ _ _ (-x))))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => Done _ _ _ tt)).
Definition funcdef_0__query (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment2)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind (bind (bind ((bind (Done _ _ _ 0%Z) (fun x => bind (bind (Done _ _ _ 0%Z) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "115" (String "117" (String "109" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (addInt64 (numberLocalGet (arrayType environment2) (String "105" (String "100" (String "120" (EmptyString))))) (Done _ _ _ 1%Z)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (Done _ _ _ 30%Z) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment2)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind (bind ((bind (liftToWithinLoop (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun a => bind (Done _ _ _ 1%Z) (fun b => Done _ _ _ (bool_decide (Z.lt a b)))))) (fun x => if x then (break (arrayType environment2)) else Done _ _ _ tt))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (addInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "115" (String "117" (String "109" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (let x := bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun x => retrieve (arrayType environment2) (String "102" (String "101" (String "110" (String "119" (String "105" (String "099" (String "107" (EmptyString)))))))) x) in ltac:(simpl in *; exact x))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "115" (String "117" (String "109" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (subInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (andBits (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun x => Done _ _ _ (-x))))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "115" (String "117" (String "109" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => Done _ _ _ tt)).
Definition funcdef_0__rangeQuery (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment2)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind (bind (bind (bind ((bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (numberLocalGet (arrayType environment2) (String "114" (String "105" (String "103" (String "104" (String "116" (EmptyString))))))) (fun y => Done _ _ _ (update x (String "105" (String "100" (String "120" (EmptyString)))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__query y x))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (subInt64 (numberLocalGet (arrayType environment2) (String "108" (String "101" (String "102" (String "116" (EmptyString)))))) (Done _ _ _ 1%Z)) (fun y => Done _ _ _ (update x (String "105" (String "100" (String "120" (EmptyString)))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__query y x)))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (subInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x) in ltac:(simpl in *; exact x)) (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => Done _ _ _ tt)).
Definition funcdef_0__update (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment2)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind (bind (bind ((bind (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (numberLocalGet (arrayType environment2) (String "105" (String "100" (String "120" (EmptyString))))) (fun y => Done _ _ _ (update x (String "108" (String "101" (String "102" (String "116" (EmptyString))))) y)))) (fun x => bind (numberLocalGet (arrayType environment2) (String "105" (String "100" (String "120" (EmptyString))))) (fun y => Done _ _ _ (update x (String "114" (String "105" (String "103" (String "104" (String "116" (EmptyString)))))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__rangeQuery y x))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (subInt64 (numberLocalGet (arrayType environment2) (String "118" (String "097" (String "108" (String "117" (String "101" (EmptyString))))))) (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x) in ltac:(simpl in *; exact x))) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (numberLocalGet (arrayType environment2) (String "105" (String "100" (String "120" (EmptyString))))) (fun y => Done _ _ _ (update x (String "105" (String "100" (String "120" (EmptyString)))) y)))) (fun x => bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x) in ltac:(simpl in *; exact x)) (fun y => Done _ _ _ (update x (String "118" (String "097" (String "108" (String "117" (String "101" (EmptyString)))))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__increase y x)))))) (fun ignored => Done _ _ _ tt)).
Definition funcdef_0__main (bools : string -> bool) (numbers : string -> Z) : Action (WithArrays (arrayType environment2)) withArraysReturnValue unit := eliminateLocalVariables bools numbers (bind (bind (bind (bind (bind (bind ((bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy))))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "110" (EmptyString)) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy)))))))) (fun ignored => (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "113" (EmptyString)) x ltac:(simpl in *; exact y)))))) (fun ignored => (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "110" (EmptyString)) x) in ltac:(simpl in *; exact x)) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment2)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind ((liftToWithinLoop (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy)))))))) (fun ignored => (liftToWithinLoop (bind (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind binder_0 (fun y => Done _ _ _ (update x (String "105" (String "100" (String "120" (EmptyString)))) y)))) (fun x => bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun y => Done _ _ _ (update x (String "118" (String "097" (String "108" (String "117" (String "101" (EmptyString)))))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__increase y x))))))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "113" (EmptyString)) x) in ltac:(simpl in *; exact x)) (fun x => loop (Z.to_nat x) (fun binder_0_intermediate => let binder_0 := Done (WithLocalVariables (arrayType environment2)) withLocalVariablesReturnValue _ (Z.sub (Z.sub x (Z.of_nat binder_0_intermediate)) 1%Z) in dropWithinLoop (bind (bind (bind (bind (bind ((liftToWithinLoop (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy)))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy))))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (bind (liftToWithinLoop (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x) in ltac:(simpl in *; exact x)) (fun x => bind (Done _ _ _ 1%Z) (fun y => Done _ _ _ (bool_decide (x = y)))))) (fun x => if x then bind (bind ((liftToWithinLoop (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy)))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "118" (String "097" (String "108" (String "117" (String "101" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (liftToWithinLoop (bind (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (subInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (Done _ _ _ 1%Z)) (fun y => Done _ _ _ (update x (String "105" (String "100" (String "120" (EmptyString)))) y)))) (fun x => bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "118" (String "097" (String "108" (String "117" (String "101" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) x) in ltac:(simpl in *; exact x)) (fun y => Done _ _ _ (update x (String "118" (String "097" (String "108" (String "117" (String "101" (EmptyString)))))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__update y x)))))) else bind (bind (bind (bind ((liftToWithinLoop (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_ReadUnsignedInt64_ y x) (arrayType environment2) (fun name => if (decide (name = String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))))) then String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy)))))))) (fun ignored => (liftToWithinLoop (bind (Done _ _ _ 0%Z) (fun x => bind (bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun tuple_element_0 => Done _ _ _ (tuple_element_0))) (fun y => store (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x ltac:(simpl in *; exact y))))))) (fun ignored => (liftToWithinLoop (bind (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (subInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "105" (String "100" (String "120" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString))))))))) x) in ltac:(simpl in *; exact x)) (Done _ _ _ 1%Z)) (fun y => Done _ _ _ (update x (String "108" (String "101" (String "102" (String "116" (EmptyString))))) y)))) (fun x => bind (subInt64 (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "116" (String "101" (String "109" (String "112" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))) x) in ltac:(simpl in *; exact x)) (Done _ _ _ 1%Z)) (fun y => Done _ _ _ (update x (String "114" (String "105" (String "103" (String "104" (String "116" (EmptyString)))))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (funcdef_0__rangeQuery y x))))))) (fun ignored => (liftToWithinLoop (bind (bind (Done _ _ _ (fun x => 0%Z)) (fun x => bind (let x := bind (Done _ _ _ 0%Z) (fun x => retrieve (arrayType environment2) (String "114" (String "101" (String "115" (String "117" (String "108" (String "116" (String "065" (String "114" (String "114" (String "097" (String "121" (EmptyString)))))))))))) x) in ltac:(simpl in *; exact x)) (fun y => Done _ _ _ (update x (String "110" (String "117" (String "109" (EmptyString)))) y)))) (fun x => bind (Done _ _ _ (fun x => false)) (fun y => liftToWithLocalVariables (translateArrays (funcdef_0_PrintInt64_unsigned y x) (arrayType environment2) (fun name => if (decide (name = String "098" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString)))))))) then String "112" (String "114" (String "105" (String "110" (String "116" (String "066" (String "117" (String "102" (String "102" (String "101" (String "114" (EmptyString))))))))))) else "aaaaaaaaaaaa") (fun name => ltac:(simpl; repeat case_decide; easy))))))))) (fun ignored => (liftToWithinLoop (bind (bind (Done _ _ _ 10%Z) (fun x => Done _ _ _ (coerceInt8 x))) (fun x => writeChar (arrayType environment2) x)))))))) (fun ignored => Done _ _ _ tt))))))) (fun ignored => Done _ _ _ tt)).
