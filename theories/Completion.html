<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Completion.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk0"><span class="kn">From</span> CoqCP <span class="kn">Require Import</span> Options ListsEqual ListDecomposition SwapUpdate.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file ssrmatching_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file ssreflect_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> numbers list.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Completion</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> : <span class="kt">Type</span>} `{EqDecision A} `{decide : EqDecision (option A)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">isCompletion</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">filled</span> : list A) :=
  <span class="kr">match</span> withBlanks, filled <span class="kr">with</span>
  | [], [] =&gt; true
  | [], (x :: _) =&gt; false
  | (_ :: _), [] =&gt; false
  | (Some a :: tail1), (b :: tail2) =&gt; bool_decide (a = b) &amp;&amp; isCompletion tail1 tail2
  | (None :: tail1), (b :: tail2) =&gt; isCompletion tail1 tail2
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">isPartialCompletion</span> (<span class="nv">withBlanks</span> <span class="nv">partialFilled</span> : list (option A)) :=
  <span class="kr">match</span> withBlanks, partialFilled <span class="kr">with</span>
  | [], [] =&gt; true
  | [], (_ :: _) =&gt; false
  | (_ :: _), [] =&gt; false
  | (Some a :: tail1), (None :: tail2) =&gt; false
  | (Some a :: tail1), (Some b :: tail2) =&gt; bool_decide (a = b) &amp;&amp; isPartialCompletion tail1 tail2
  | (None :: tail1), (_ :: tail2) =&gt; isPartialCompletion tail1 tail2
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1"><span class="kn">Lemma</span> <span class="nf">isCompletionMeansLengthEqual</span> : <span class="kr">forall</span> <span class="nv">withBlanks</span> <span class="nv">filled</span>, isCompletion withBlanks filled -&gt; length withBlanks = length filled.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list (option A)) (<span class="nv">_1</span> : list A),
  isCompletion _0 _1 ‚Üí length _0 = length _1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">_0</span> : list (option A)) (<span class="nv">_1</span> : list A),
  isCompletion _0 _1 ‚Üí length _0 = length _1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk3"><span class="nb">intros</span> withBlanks filled.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>filled</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion withBlanks filled
‚Üí length withBlanks = length filled</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk4"><span class="nb">revert</span> withBlanks.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>filled</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list (option A),
  isCompletion _0 filled ‚Üí length _0 = length filled</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> filled <span class="kr">as</span> [| head tail IH];
  <span class="nb">intros</span> [| [head1 |] tail1] h; <span class="nb">simpl</span> <span class="kr">in</span> *;
  <span class="kp">try</span> <span class="nb">apply</span> eq_S, IH; <span class="bp">now</span> <span class="kp">try</span> case_bool_decide.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk5"><span class="kn">Lemma</span> <span class="nf">isPartialCompletionMeansLengthEqual</span> : <span class="kr">forall</span> <span class="nv">withBlanks</span> <span class="nv">partialFilled</span>, isPartialCompletion withBlanks partialFilled -&gt; length withBlanks = length partialFilled.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : list (option A),
  isPartialCompletion _0 _1 ‚Üí length _0 = length _1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : list (option A),
  isPartialCompletion _0 _1 ‚Üí length _0 = length _1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk7"><span class="nb">intros</span> withBlanks partialFilled.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks, partialFilled</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion withBlanks partialFilled
‚Üí length withBlanks = length partialFilled</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk8"><span class="nb">revert</span> withBlanks.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>partialFilled</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list (option A),
  isPartialCompletion _0 partialFilled
  ‚Üí length _0 = length partialFilled</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> partialFilled <span class="kr">as</span> [| [head |] tail IH];
  <span class="nb">intros</span> [| [head1 |] tail1] h; <span class="nb">simpl</span> <span class="kr">in</span> *;
  <span class="kp">try</span> <span class="nb">apply</span> eq_S, IH; <span class="bp">now</span> <span class="kp">try</span> case_bool_decide.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">fillPartial</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">answers</span> : list A) :=
  <span class="kr">match</span> withBlanks, answers <span class="kr">with</span>
  | [], _ =&gt; []
  | (Some a :: tail), x =&gt; Some a :: fillPartial tail x
  | (None :: tail), (x :: tail&#39;) =&gt; Some x :: fillPartial tail tail&#39;
  | (None :: tail), [] =&gt; None :: tail
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk9"><span class="kn">Lemma</span> <span class="nf">fillPartialPreservesLength</span> <span class="nv">withBlanks</span> : <span class="kr">forall</span> <span class="nv">answers</span>, length (fillPartial withBlanks answers) = length withBlanks.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length (fillPartial withBlanks _0) =
  length withBlanks</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length (fillPartial withBlanks _0) =
  length withBlanks</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH];
  <span class="nb">intros</span> [| head1 tail1]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">now</span> <span class="kp">try</span> <span class="nb">apply</span> eq_S.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">stripOptions</span> (<span class="nv">l</span> : list (option A)) (<span class="nv">default</span> : A) : list A :=
  <span class="kr">match</span> l <span class="kr">with</span>
  | [] =&gt; []
  | (Some head :: tail) =&gt; head :: stripOptions tail default
  | (None :: tail) =&gt; default :: stripOptions tail default
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb"><span class="kn">Lemma</span> <span class="nf">stripOptionsPreservesLength</span> (<span class="nv">l</span> : list (option A)) (<span class="nv">default</span> : A) : length l = length (stripOptions l default).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length l = length (stripOptions l default)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length l = length (stripOptions l default)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> l <span class="kr">as</span> [| [head |] tail IH]; <span class="nb">simpl</span>; <span class="bp">now</span> <span class="kp">try</span> <span class="nb">apply</span> eq_S, IH.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkd"><span class="kn">Lemma</span> <span class="nf">noNoneIfCorrectLength</span> <span class="nv">withBlanks</span> <span class="nv">answers</span> (<span class="nv">h</span> : length answers = count_occ decide withBlanks None) : Forall is_Some (fillPartial withBlanks answers).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers = count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial withBlanks answers)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chke"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers = count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial withBlanks answers)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkf"><span class="nb">revert</span> answers h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide withBlanks None
  ‚Üí Forall is_Some (fillPartial withBlanks _0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk10"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH]; <span class="nb">intros</span> [| head1 tail1] h; <span class="kp">try</span> <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">now</span> <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (Some head :: fillPartial tail [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (Some head :: tail) None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk11"><hr></label><div class="goal-conclusion">Forall is_Some
  (Some head :: fillPartial tail (head1 :: tail1))</div></blockquote><input class="alectryon-extra-goal-toggle" id="Completion-v-chk12" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] = count_occ decide (None :: tail) None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk12"><hr></label><div class="goal-conclusion">Forall is_Some (None :: tail)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Completion-v-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (None :: tail) None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk13"><hr></label><div class="goal-conclusion">Forall is_Some (Some head1 :: fillPartial tail tail1)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk14">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (Some head :: fillPartial tail [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk15"><span class="nb">apply</span> Forall_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_Some (Some head)
‚àß Forall is_Some (fillPartial tail [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk16"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial tail [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk17"><span class="nb">rewrite</span> count_occ_cons_neq <span class="kr">in</span> h; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] = count_occ decide tail None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial tail [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (IH _ h).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk18">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some
  (Some head :: fillPartial tail (head1 :: tail1))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk19"><span class="nb">apply</span> Forall_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_Some (Some head)
‚àß Forall is_Some (fillPartial tail (head1 :: tail1))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1a"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (Some head :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial tail (head1 :: tail1))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1b"><span class="nb">rewrite</span> count_occ_cons_neq <span class="kr">in</span> h; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide tail None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial tail (head1 :: tail1))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (IH _ h).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length [] = count_occ decide (None :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (None :: tail)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> count_occ_cons_eq <span class="kr">in</span> h; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (None :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (Some head1 :: fillPartial tail tail1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1e"><span class="nb">apply</span> Forall_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (None :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_Some (Some head1)
‚àß Forall is_Some (fillPartial tail tail1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk1f"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
count_occ decide (None :: tail) None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial tail tail1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk20"><span class="nb">rewrite</span> count_occ_cons_eq <span class="kr">in</span> h; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí Forall is_Some (fillPartial tail _0)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length (head1 :: tail1) =
S (count_occ decide tail None)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall is_Some (fillPartial tail tail1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (IH tail1 <span class="kp">ltac</span>:(<span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">lia</span>)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk21"><span class="kn">Lemma</span> <span class="nf">rightLengthApp</span> (<span class="nv">w1</span> <span class="nv">w2</span> : list (option A)) (<span class="nv">s1</span> <span class="nv">s2</span> : list A) :
  length s1 = count_occ decide w1 None -&gt;
  length s2 = count_occ decide w2 None -&gt;
  length (s1 ++ s2) = count_occ decide (w1 ++ w2) None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>w1, w2</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s1 = count_occ decide w1 None
‚Üí length s2 = count_occ decide w2 None
  ‚Üí length (s1 ++ s2) =
    count_occ decide (w1 ++ w2) None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk22"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>w1, w2</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s1 = count_occ decide w1 None
‚Üí length s2 = count_occ decide w2 None
  ‚Üí length (s1 ++ s2) =
    count_occ decide (w1 ++ w2) None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk23"><span class="nb">rewrite</span> count_occ_app, app_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>w1, w2</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s1 = count_occ decide w1 None
‚Üí length s2 = count_occ decide w2 None
  ‚Üí length s1 + length s2 =
    count_occ decide w1 None +
    count_occ decide w2 None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">fill</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">toFill</span> : list A) : list A :=
  <span class="kr">match</span> withBlanks, toFill <span class="kr">with</span>
  | [], _ =&gt; []
  | (None :: tail), (toFill :: remaining) =&gt; toFill :: fill tail remaining
  | (None :: tail), [] =&gt; []
  | (Some stuff :: tail), remaining =&gt; stuff :: fill tail remaining
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk24"><span class="kn">Lemma</span> <span class="nf">fillApp</span> (<span class="nv">w1</span> <span class="nv">w2</span> : list (option A)) (<span class="nv">s1</span> <span class="nv">s2</span> : list A)
  (<span class="nv">h1</span> : length s1 = count_occ decide w1 None)
  (<span class="nv">h2</span> : length s2 = count_occ decide w2 None) :
  fill (w1 ++ w2) (s1 ++ s2) = fill w1 s1 ++ fill w2 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>w1, w2</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>length s1 = count_occ decide w1 None</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>length s2 = count_occ decide w2 None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (w1 ++ w2) (s1 ++ s2) = fill w1 s1 ++ fill w2 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk25"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>w1, w2</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>length s1 = count_occ decide w1 None</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>length s2 = count_occ decide w2 None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (w1 ++ w2) (s1 ++ s2) = fill w1 s1 ++ fill w2 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">revert</span> s1 h1; <span class="nb">induction</span> w1 <span class="kr">as</span> [| [b |] w1 IHw1]; <span class="nb">intros</span> s1 h1; <span class="nb">destruct</span> s1 <span class="kr">as</span> [| b1 s1];
  <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="nb">rewrite</span> &lt;- IHw1; <span class="kp">try</span> (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk26"><span class="kn">Lemma</span> <span class="nf">partialCompletionTransitive</span> (<span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s3</span> : list (option A)) (<span class="nv">h1</span> : isPartialCompletion s1 s2) (<span class="nv">h2</span> : isPartialCompletion s2 s3) : isPartialCompletion s1 s3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>s1, s2, s3</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>isPartialCompletion s1 s2</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>isPartialCompletion s2 s3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion s1 s3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk27"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>s1, s2, s3</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>isPartialCompletion s1 s2</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>isPartialCompletion s2 s3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion s1 s3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> s1 <span class="kr">as</span> [| [b1 |] s1 IH] <span class="kr">in</span> s2, s3, h1, h2 |- *; <span class="nb">destruct</span> s2 <span class="kr">as</span> [| [head2 |] tail2]; <span class="nb">destruct</span> s3 <span class="kr">as</span> [| [head3 |] tail3]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">rewrite</span> <span class="nl">?andb_True</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">destruct</span> h1; <span class="kp">try</span> <span class="nb">destruct</span> h2; <span class="nb">rewrite</span> <span class="nl">?bool_decide_spec</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="nb">apply</span> (IH tail2 _); <span class="kp">try</span> (<span class="bp">congruence</span> || <span class="bp">tauto</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">extractAnswers</span> (<span class="nv">s</span> : list (option A)) (<span class="nv">completed</span> : list A) :=
  <span class="kr">match</span> s, completed <span class="kr">with</span>
  | (Some _ :: tail1), (head2 :: tail2) =&gt; extractAnswers tail1 tail2
  | (None :: tail1), (head2 :: tail2) =&gt; head2 :: extractAnswers tail1 tail2
  | [], _ =&gt; []
  | _, [] =&gt; []
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk28"><span class="kn">Lemma</span> <span class="nf">extractAnswersLength</span> (<span class="nv">s</span> : list (option A)) (<span class="nv">completed</span> : list A) (<span class="nv">h</span> : isCompletion s completed): length (extractAnswers s completed) = count_occ decide s None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>completed</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>isCompletion s completed</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (extractAnswers s completed) =
count_occ decide s None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk29"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>completed</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>isCompletion s completed</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (extractAnswers s completed) =
count_occ decide s None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk2a"><span class="nb">induction</span> s <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> completed, h |- *; <span class="nb">destruct</span> completed <span class="kr">as</span> [| head1 tail1]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> (<span class="bp">done</span> || <span class="bp">lia</span>); <span class="nb">rewrite</span> <span class="nl">?andb_True</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>bool_decide (head = head1)
‚àß isCompletion tail tail1</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  isCompletion tail _0
  ‚Üí length (extractAnswers tail _0) =
    count_occ decide tail None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some head ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (extractAnswers tail tail1) =
count_occ decide tail None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>isCompletion tail tail1</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  isCompletion tail _0
  ‚Üí length (extractAnswers tail _0) =
    count_occ decide tail None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>None = None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk2b"><hr></label><div class="goal-conclusion">S (length (extractAnswers tail tail1)) =
S (count_occ decide tail None)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk2c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>bool_decide (head = head1)
‚àß isCompletion tail tail1</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  isCompletion tail _0
  ‚Üí length (extractAnswers tail _0) =
    count_occ decide tail None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some head ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (extractAnswers tail tail1) =
count_occ decide tail None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- (IH _ (proj2 h)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk2d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>isCompletion tail tail1</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  isCompletion tail _0
  ‚Üí length (extractAnswers tail _0) =
    count_occ decide tail None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>None = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (extractAnswers tail tail1)) =
S (count_occ decide tail None)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- (IH _ h).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk2e"><span class="kn">Lemma</span> <span class="nf">extractAnswersCorrect</span> (<span class="nv">s</span> : list (option A)) (<span class="nv">completed</span> : list A) (<span class="nv">h</span> : isCompletion s completed) (<span class="nv">h1</span> : length (extractAnswers s completed) = count_occ decide s None) : fill s (extractAnswers s completed) = completed.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>completed</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>isCompletion s completed</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>length (extractAnswers s completed) =
count_occ decide s None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill s (extractAnswers s completed) = completed</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>completed</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>isCompletion s completed</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>length (extractAnswers s completed) =
count_occ decide s None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill s (extractAnswers s completed) = completed</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> s <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> completed, h, h1 |- *;
  <span class="nb">destruct</span> completed <span class="kr">as</span> [| head1 tail1];
  <span class="nb">simpl</span> <span class="kr">in</span> *;
  <span class="kp">try</span> <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="bp">done</span>;
  <span class="nb">rewrite</span> <span class="nl">?andb_True</span>, <span class="nl">?bool_decide_spec</span> <span class="kr">in</span> *;
  <span class="nb">rewrite</span> <span class="nl">?IH</span>; <span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk30"><span class="kn">Lemma</span> <span class="nf">fillIsCompletion</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">answers</span> : list A) (<span class="nv">h</span> : length answers = count_occ decide withBlanks None) : isCompletion withBlanks (fill withBlanks answers).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers = count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion withBlanks (fill withBlanks answers)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk31"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers = count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion withBlanks (fill withBlanks answers)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk32"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> answers, h |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers = count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion [] (fill [] answers)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers =
count_occ decide (Some head :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí isCompletion tail (fill tail _0)</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk33"><hr></label><div class="goal-conclusion">isCompletion (Some head :: tail)
  (fill (Some head :: tail) answers)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Completion-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers =
count_occ decide (None :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí isCompletion tail (fill tail _0)</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk34"><hr></label><div class="goal-conclusion">isCompletion (None :: tail)
  (fill (None :: tail) answers)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk35">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers = count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion [] (fill [] answers)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk36">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers =
count_occ decide (Some head :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí isCompletion tail (fill tail _0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion (Some head :: tail)
  (fill (Some head :: tail) answers)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> answers <span class="kr">as</span> [| head1 tail1]; <span class="nb">simpl</span>; case_bool_decide; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="bp">now</span> <span class="nb">apply</span> IH.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk37">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers =
count_occ decide (None :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí isCompletion tail (fill tail _0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion (None :: tail)
  (fill (None :: tail) answers)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk38"><span class="nb">destruct</span> answers <span class="kr">as</span> [| head1 tail1]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>None = None</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>S (length tail1) = S (count_occ decide tail None)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí isCompletion tail (fill tail _0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isCompletion tail (fill tail tail1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk39"><span class="nb">apply</span> IH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>head1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>None = None</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>S (length tail1) = S (count_occ decide tail None)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : list A,
  length _0 = count_occ decide tail None
  ‚Üí isCompletion tail (fill tail _0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length tail1 = count_occ decide tail None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">getKthBlank</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) :=
  <span class="kr">match</span> withBlanks, k <span class="kr">with</span>
  | [], _ =&gt; <span class="mi">0</span> <span class="c">(* who cares *)</span>
  | (Some _ :: tail), k =&gt; S (getKthBlank tail k)
  | (None :: tail), <span class="mi">0</span> =&gt; <span class="mi">0</span>
  | (None :: tail), S k =&gt; S (getKthBlank tail k)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk3a"><span class="kn">Lemma</span> <span class="nf">nthGetKthBlank</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">default</span> : option A) (<span class="nv">hReasonable</span> : k &lt; count_occ decide withBlanks None) : nth (getKthBlank withBlanks k) withBlanks default = None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank withBlanks k) withBlanks default =
None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk3b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank withBlanks k) withBlanks default =
None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk3c"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> k, hReasonable |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank [] k) [] default = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk3d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt;
count_occ decide (Some head :: tail)
  None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí nth (getKthBlank tail _0) tail default = None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk3d"><hr></label><div class="goal-conclusion">nth (getKthBlank (Some head :: tail) k)
  (Some head :: tail) default = None</div></blockquote><input class="alectryon-extra-goal-toggle" id="Completion-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (None :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí nth (getKthBlank tail _0) tail default = None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk3e"><hr></label><div class="goal-conclusion">nth (getKthBlank (None :: tail) k) 
  (None :: tail) default = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk3f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank [] k) [] default = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk40"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">default = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk41">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt;
count_occ decide (Some head :: tail)
  None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí nth (getKthBlank tail _0) tail default = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank (Some head :: tail) k)
  (Some head :: tail) default = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk42"><span class="nb">simpl</span> <span class="kr">in</span> hReasonable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt;
(<span class="kr">if</span> decide (Some head) None
 <span class="kr">then</span> S (count_occ decide tail None)
 <span class="kr">else</span> count_occ decide tail None)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí nth (getKthBlank tail _0) tail default = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank (Some head :: tail) k)
  (Some head :: tail) default = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (decide (Some head) None); <span class="nb">destruct</span> k; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">rewrite</span> IH; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk43">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (None :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí nth (getKthBlank tail _0) tail default = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank (None :: tail) k) (None :: tail)
  default = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk44"><span class="nb">simpl</span> <span class="kr">in</span> hReasonable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt;
(<span class="kr">if</span> decide None None
 <span class="kr">then</span> S (count_occ decide tail None)
 <span class="kr">else</span> count_occ decide tail None)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí nth (getKthBlank tail _0) tail default = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth (getKthBlank (None :: tail) k) (None :: tail)
  default = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (decide None None); <span class="nb">destruct</span> k; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">rewrite</span> IH; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk45"><span class="kn">Lemma</span> <span class="nf">getKthBlankUpperBound</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">hReasonable</span> : k &lt; count_occ decide withBlanks None) : getKthBlank withBlanks k &lt; length withBlanks.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k &lt; length withBlanks</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk46"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k &lt; length withBlanks</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk47"><span class="nb">pose proof</span> (<span class="kp">ltac</span>:(<span class="nb">intros</span>; <span class="bp">lia</span>) : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : nat, x &lt; y -&gt; S x &lt; S y) <span class="kr">as</span> m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k &lt; length withBlanks</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk48"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> k, hReasonable |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank [] k &lt; length []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk49" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (head :: tail) None</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí getKthBlank tail _0 &lt; length tail</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk49"><hr></label><div class="goal-conclusion">getKthBlank (head :: tail) k &lt; length (head :: tail)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk4a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank [] k &lt; length []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk4b"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; <span class="mi">0</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk4c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (head :: tail) None</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí getKthBlank tail _0 &lt; length tail</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank (head :: tail) k &lt; length (head :: tail)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> head; <span class="nb">simpl</span> <span class="kr">in</span> hReasonable; <span class="nb">destruct</span> (decide _ _); <span class="nb">destruct</span> k <span class="kr">as</span> [| k]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">apply</span> m; <span class="kp">try</span> <span class="nb">refine</span> (IH _ _); <span class="kp">try</span> (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk4d"><span class="kn">Lemma</span> <span class="nf">takeKthBlankCountOcc</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">hReasonable</span> : k &lt; count_occ decide withBlanks None) : count_occ decide (take (getKthBlank withBlanks k) withBlanks) None = k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None =
k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk4e"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> k, hReasonable |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (take (getKthBlank [] k) []) None = k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk4f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (head :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí count_occ decide
      (take (getKthBlank tail _0) tail) None = _0</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk4f"><hr></label><div class="goal-conclusion">count_occ decide
  (take (getKthBlank (head :: tail) k) (head :: tail))
  None = k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk50">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (take (getKthBlank [] k) []) None = k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk51"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk52">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (head :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí count_occ decide
      (take (getKthBlank tail _0) tail) None = _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank (head :: tail) k) (head :: tail))
  None = k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> k; <span class="nb">destruct</span> head; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="nb">rewrite</span> IH; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk53"><span class="kn">Lemma</span> <span class="nf">dropKthBlankCountOcc</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) : count_occ decide (drop (getKthBlank withBlanks k) withBlanks) None = count_occ decide withBlanks None - k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (getKthBlank withBlanks k) withBlanks) None =
count_occ decide withBlanks None - k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk54"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> k |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (drop (getKthBlank [] k) []) None =
count_occ decide [] None - k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk55" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  count_occ decide
    (drop (getKthBlank tail _0) tail) None =
  count_occ decide tail None - _0</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk55"><hr></label><div class="goal-conclusion">count_occ decide
  (drop (getKthBlank (head :: tail) k) (head :: tail))
  None = count_occ decide (head :: tail) None - k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk56">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (drop (getKthBlank [] k) []) None =
count_occ decide [] None - k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk57"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span> - k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk58">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  count_occ decide
    (drop (getKthBlank tail _0) tail) None =
  count_occ decide tail None - _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (getKthBlank (head :: tail) k) (head :: tail))
  None = count_occ decide (head :: tail) None - k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> k; <span class="nb">destruct</span> head; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="nb">rewrite</span> IH; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk59"><span class="kn">Lemma</span> <span class="nf">dropSuccKthBlankCountOcc</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) : count_occ decide (drop (S (getKthBlank withBlanks k)) withBlanks) None = count_occ decide withBlanks None - k - <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None = count_occ decide withBlanks None - k - <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk5a"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> k |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (drop (S (getKthBlank [] k)) []) None =
count_occ decide [] None - k - <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk5b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  count_occ decide
    (drop (S (getKthBlank tail _0)) tail) None =
  count_occ decide tail None - _0 - <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="Completion-v-chk5b"><hr></label><div class="goal-conclusion">count_occ decide
  (drop (S (getKthBlank (head :: tail) k))
     (head :: tail)) None =
count_occ decide (head :: tail) None - k - <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk5c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (drop (S (getKthBlank [] k)) []) None =
count_occ decide [] None - k - <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk5d"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk5e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  count_occ decide
    (drop (S (getKthBlank tail _0)) tail) None =
  count_occ decide tail None - _0 - <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (S (getKthBlank (head :: tail) k))
     (head :: tail)) None =
count_occ decide (head :: tail) None - k - <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> k; <span class="nb">destruct</span> head; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="nb">rewrite</span> IH; <span class="kp">try</span> <span class="nb">rewrite</span> drop_0; <span class="kp">try</span> (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk5f"><span class="kn">Lemma</span> <span class="nf">dropSuccTakeKthBlankCountOcc</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hLt</span> : i &lt;= j) (<span class="nv">hReasonable</span> : j &lt; count_occ decide withBlanks None) : count_occ decide (drop (S (getKthBlank withBlanks i)) (take (getKthBlank withBlanks j) withBlanks)) None = j - i - <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (S (getKthBlank withBlanks i))
     (take (getKthBlank withBlanks j) withBlanks))
  None = j - i - <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk60"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (S (getKthBlank withBlanks i))
     (take (getKthBlank withBlanks j) withBlanks))
  None = j - i - <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk61"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> i, j, hLt, hReasonable |- *; <span class="kp">try</span> <span class="bp">easy</span>;
  <span class="nb">destruct</span> i <span class="kr">as</span> [| i]; <span class="nb">destruct</span> j <span class="kr">as</span> [| j]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">rewrite</span> IH; <span class="kp">try</span> <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> (<span class="bp">done</span> || <span class="bp">lia</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ‚â§ S j</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>None = None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>S j &lt; S (count_occ decide tail None)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _0 ‚â§ _1
  ‚Üí _1 &lt; count_occ decide tail None
    ‚Üí count_occ decide
        (drop (S (getKthBlank tail _0))
           (take (getKthBlank tail _1) tail))
        None = _1 - _0 - <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop <span class="mi">0</span> (take (getKthBlank tail j) tail)) None =
j - <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> drop_0, takeKthBlankCountOcc; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk62"><span class="kn">Lemma</span> <span class="nf">dropTakeKthBlankCountOcc</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hLt</span> : i &lt;= j) (<span class="nv">hReasonable</span> : j &lt; count_occ decide withBlanks None) : count_occ decide (drop (getKthBlank withBlanks i) (take (getKthBlank withBlanks j) withBlanks)) None = j - i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (getKthBlank withBlanks i)
     (take (getKthBlank withBlanks j) withBlanks))
  None = j - i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i ‚â§ j</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (drop (getKthBlank withBlanks i)
     (take (getKthBlank withBlanks j) withBlanks))
  None = j - i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk64"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> i, j, hLt, hReasonable |- *; <span class="kp">try</span> <span class="bp">easy</span>;
  <span class="nb">destruct</span> i <span class="kr">as</span> [| i]; <span class="nb">destruct</span> j <span class="kr">as</span> [| j]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="nb">rewrite</span> IH; <span class="kp">try</span> <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> (<span class="bp">done</span> || <span class="bp">lia</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ‚â§ S j</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>None = None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>S j &lt; S (count_occ decide tail None)</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat,
  _0 ‚â§ _1
  ‚Üí _1 &lt; count_occ decide tail None
    ‚Üí count_occ decide
        (drop (getKthBlank tail _0)
           (take (getKthBlank tail _1) tail))
        None = _1 - _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S
  (count_occ decide (take (getKthBlank tail j) tail)
     None) = S j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> takeKthBlankCountOcc; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk65"><span class="kn">Lemma</span> <span class="nf">fillSplit</span> (<span class="nv">b</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A) (<span class="nv">withBlanks</span> : list (option A)) <span class="nv">k</span> (<span class="nv">hK</span> : k = length s1) : length (s1 ++ [b] ++ s2) = count_occ decide withBlanks None -&gt; withBlanks = take (getKthBlank withBlanks k) withBlanks ++ [None] ++ drop (S (getKthBlank withBlanks k)) withBlanks /\ length s1 = count_occ decide (take (getKthBlank withBlanks k) withBlanks) None /\ length s2 = count_occ decide (drop (S (getKthBlank withBlanks k)) withBlanks) None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None
‚Üí withBlanks =
  take (getKthBlank withBlanks k) withBlanks ++
  [None] ++
  drop (S (getKthBlank withBlanks k)) withBlanks
  ‚àß length s1 =
    count_occ decide
      (take (getKthBlank withBlanks k) withBlanks)
      None
    ‚àß length s2 =
      count_occ decide
        (drop (S (getKthBlank withBlanks k))
           withBlanks) None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk66"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None
‚Üí withBlanks =
  take (getKthBlank withBlanks k) withBlanks ++
  [None] ++
  drop (S (getKthBlank withBlanks k)) withBlanks
  ‚àß length s1 =
    count_occ decide
      (take (getKthBlank withBlanks k) withBlanks)
      None
    ‚àß length s2 =
      count_occ decide
        (drop (S (getKthBlank withBlanks k))
           withBlanks) None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk67"><span class="nb">intro</span> hLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks
‚àß length s1 =
  count_occ decide
    (take (getKthBlank withBlanks k) withBlanks) None
  ‚àß length s2 =
    count_occ decide
      (drop (S (getKthBlank withBlanks k)) withBlanks)
      None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk68"><span class="nb">pose proof</span> <span class="kp">ltac</span>:(<span class="nb">rewrite</span> !app_length <span class="kr">in</span> hLength; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">lia</span>) : k &lt; count_occ decide withBlanks None <span class="kr">as</span> hReasonable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks
‚àß length s1 =
  count_occ decide
    (take (getKthBlank withBlanks k) withBlanks) None
  ‚àß length s2 =
    count_occ decide
      (drop (S (getKthBlank withBlanks k)) withBlanks)
      None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk69"><span class="nb">pose proof</span> getKthBlankUpperBound withBlanks k <span class="kp">ltac</span>:(<span class="bp">lia</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks
‚àß length s1 =
  count_occ decide
    (take (getKthBlank withBlanks k) withBlanks) None
  ‚àß length s2 =
    count_occ decide
      (drop (S (getKthBlank withBlanks k)) withBlanks)
      None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk6a"><span class="nb">assert</span> (hCountOcc1 : count_occ decide (take (getKthBlank withBlanks k) withBlanks) None = k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None =
k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk6b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk6b"><hr></label><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks
‚àß length s1 =
  count_occ decide
    (take (getKthBlank withBlanks k) withBlanks) None
  ‚àß length s2 =
    count_occ decide
      (drop (S (getKthBlank withBlanks k)) withBlanks)
      None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk6c">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None =
k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk6d"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| head tail IH] <span class="kr">in</span> k, hReasonable |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (take (getKthBlank [] k) []) None = k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (head :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí count_occ decide
      (take (getKthBlank tail _0) tail) None = _0</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk6e"><hr></label><div class="goal-conclusion">count_occ decide
  (take (getKthBlank (head :: tail) k) (head :: tail))
  None = k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk6f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide [] None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide (take (getKthBlank [] k) []) None = k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk70"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk71">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>head</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>tail</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide (head :: tail) None</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> : nat,
  _0 &lt; count_occ decide tail None
  ‚Üí count_occ decide
      (take (getKthBlank tail _0) tail) None = _0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank (head :: tail) k) (head :: tail))
  None = k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> k; <span class="nb">destruct</span> head; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="nb">rewrite</span> IH; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk72">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks
‚àß length s1 =
  count_occ decide
    (take (getKthBlank withBlanks k) withBlanks) None
  ‚àß length s2 =
    count_occ decide
      (drop (S (getKthBlank withBlanks k)) withBlanks)
      None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk73"><span class="kp">repeat</span> <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk74"><hr></label><div class="goal-conclusion">length s1 =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None</div></blockquote><input class="alectryon-extra-goal-toggle" id="Completion-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk75"><hr></label><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk76">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- (nthGetKthBlank withBlanks k None), &lt;- listDecompositionSingle.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk77">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s1 =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk78">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk79"><span class="nb">pose proof</span> nthGetKthBlank withBlanks k None hReasonable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk7a"><span class="nb">assert</span> (hIntermediate : count_occ decide (take (getKthBlank withBlanks k) withBlanks) None + count_occ decide [nth (getKthBlank withBlanks k) withBlanks None] None + count_occ decide (drop (S (getKthBlank withBlanks k)) withBlanks) None = count_occ decide withBlanks None).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  [nth (getKthBlank withBlanks k) withBlanks None]
  None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None = count_occ decide withBlanks None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>hIntermediate</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None +
count_occ decide
  [nth (getKthBlank withBlanks k)
     withBlanks None] None +
count_occ decide
  (drop (S (getKthBlank withBlanks k))
     withBlanks) None =
count_occ decide withBlanks None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk7b"><hr></label><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk7c">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  [nth (getKthBlank withBlanks k) withBlanks None]
  None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None = count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- !count_occ_app, (<span class="kp">ltac</span>:(<span class="nb">intros</span>; listsEqual) : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : list A), (a ++ b) ++ c = a ++ b ++ c), &lt;- listDecompositionSingle.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk7d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>hIntermediate</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None +
count_occ decide
  [nth (getKthBlank withBlanks k)
     withBlanks None] None +
count_occ decide
  (drop (S (getKthBlank withBlanks k))
     withBlanks) None =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk7e"><span class="nb">simpl</span> <span class="kr">in</span> hIntermediate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>hIntermediate</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None +
(<span class="kr">if</span>
  decide
    (nth (getKthBlank withBlanks k)
       withBlanks None) None
 <span class="kr">then</span> <span class="mi">1</span>
 <span class="kr">else</span> <span class="mi">0</span>) +
count_occ decide
  (drop (S (getKthBlank withBlanks k))
     withBlanks) None =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk7f"><span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length (s1 ++ [b] ++ s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2, _3</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>hIntermediate</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None + <span class="mi">1</span> +
count_occ decide
  (drop (S (getKthBlank withBlanks k))
     withBlanks) None =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk80"><span class="nb">rewrite</span> !app_length <span class="kr">in</span> hLength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length s1 + (length [b] + length s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2, _3</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>hIntermediate</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None + <span class="mi">1</span> +
count_occ decide
  (drop (S (getKthBlank withBlanks k))
     withBlanks) None =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk81"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>k = length s1</span></span></span><br><span><var>hLength</var><span class="hyp-type"><b>: </b><span>length s1 + S (length s2) =
count_occ decide withBlanks None</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt; length withBlanks</span></span></span><br><span><var>hCountOcc1</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None = k</span></span></span><br><span><var>_2, _3</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>hIntermediate</var><span class="hyp-type"><b>: </b><span>count_occ decide
  (take (getKthBlank withBlanks k)
     withBlanks) None + <span class="mi">1</span> +
count_occ decide
  (drop (S (getKthBlank withBlanks k))
     withBlanks) None =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s2 =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk82"><span class="kn">Lemma</span> <span class="nf">fillInOneBlank_h1Parameter</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">hReasonable</span>: k &lt; count_occ decide withBlanks None) (<span class="nv">value</span> : A) (<span class="nv">answers</span> : list A) (<span class="nv">h</span> : length answers + <span class="mi">1</span> = count_occ decide withBlanks None) : length (take k answers ++ [value] ++ drop k answers) = count_occ decide withBlanks None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take k answers ++ [value] ++ drop k answers) =
count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk83"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take k answers ++ [value] ++ drop k answers) =
count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk84"><span class="nb">rewrite</span> !app_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take k answers) +
(length [value] + length (drop k answers)) =
count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk85"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take k answers) + S (length (drop k answers)) =
count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk86"><span class="nb">rewrite</span> Nat.add_succ_r, &lt;- app_length, take_drop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length answers) = count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk87"><span class="kn">Lemma</span> <span class="nf">fillInOneBlank_h2Parameter</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">hReasonable</span>: k &lt; count_occ decide withBlanks None) (<span class="nv">value</span> : A) (<span class="nv">answers</span> : list A) (<span class="nv">h</span> : length answers + <span class="mi">1</span> = count_occ decide withBlanks None) : length answers = count_occ decide (&lt;[getKthBlank withBlanks k := Some value]&gt; withBlanks) None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk88"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk89"><span class="nb">pose proof</span> getKthBlankUpperBound _ _ hReasonable <span class="kr">as</span> hUpperBound.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk8a"><span class="nb">pose proof</span> updateAppZero (take (getKthBlank withBlanks k) withBlanks) ([nth (getKthBlank withBlanks k) withBlanks None] ++ drop (S (getKthBlank withBlanks k)) withBlanks) (Some value) <span class="kr">as</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[length
    (take (getKthBlank withBlanks k) withBlanks):=
  Some value]&gt;
  (take (getKthBlank withBlanks k) withBlanks ++
   [nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks) =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk8b"><span class="nb">rewrite</span> &lt;- (listDecompositionSingle withBlanks (getKthBlank withBlanks k) hUpperBound None) <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[length
    (take (getKthBlank withBlanks k) withBlanks):=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk8c"><span class="nb">rewrite</span> take_length <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk8d"><span class="nb">assert</span> (hMin : getKthBlank withBlanks k `min` length withBlanks = getKthBlank withBlanks k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k `min` length withBlanks =
getKthBlank withBlanks k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk8e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk8e"><hr></label><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk8f">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k `min` length withBlanks =
getKthBlank withBlanks k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk90">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk91"><span class="nb">rewrite</span> hMin <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk92"><span class="nb">rewrite</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks ++
   &lt;[<span class="mi">0</span>:=Some value]&gt;
     ([nth (getKthBlank withBlanks k) withBlanks None] ++
      drop (S (getKthBlank withBlanks k)) withBlanks))
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk93"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk94"><span class="nb">rewrite</span> (<span class="kp">ltac</span>:(<span class="bp">now</span> <span class="nb">intros</span>) : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">head</span> : A) (<span class="nv">tail</span> : list A), head :: tail = [head] ++ tail), !count_occ_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
(count_occ decide [Some value] None +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk95"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
((<span class="kr">if</span> decide (Some value) None <span class="kr">then</span> <span class="mi">1</span> <span class="kr">else</span> <span class="mi">0</span>) +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk96"><span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
(<span class="mi">0</span> +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk97"><span class="nb">rewrite</span> Nat.add_0_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk98"><span class="nb">rewrite</span> (listDecompositionSingle withBlanks (getKthBlank withBlanks k) hUpperBound None), !count_occ_app <span class="kr">in</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None +
(count_occ decide
   [nth (getKthBlank withBlanks k) withBlanks None]
   None +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk99"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None +
((<span class="kr">if</span>
   decide
     (nth (getKthBlank withBlanks k) withBlanks
        None) None
  <span class="kr">then</span> <span class="mi">1</span>
  <span class="kr">else</span> <span class="mi">0</span>) +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
Some value
:: drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk9a"><span class="nb">destruct</span> (decide _ _) <span class="kr">as</span> [| h&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None +
(<span class="mi">1</span> +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
Some value
:: drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None
‚â† None</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None +
(<span class="mi">0</span> +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
Some value
:: drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chk9b"><hr></label><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>_2</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None =
None</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None +
(<span class="mi">1</span> +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
Some value
:: drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk9d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>nth (getKthBlank withBlanks k) withBlanks None
‚â† None</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None +
(<span class="mi">0</span> +
 count_occ decide
   (drop (S (getKthBlank withBlanks k)) withBlanks)
   None)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
Some value
:: drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>_1</var><span class="hyp-type"><b>: </b><span>Some value ‚â† None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length answers =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks) None +
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> nthGetKthBlank <span class="kr">in</span> h&#39;; (<span class="bp">lia</span> || <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk9e"><span class="kn">Lemma</span> <span class="nf">fillInOneBlank</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">hReasonable</span> : k &lt; count_occ decide withBlanks None) (<span class="nv">value</span> : A) (<span class="nv">answers</span> : list A) (<span class="nv">h</span> : length answers + <span class="mi">1</span> = count_occ decide withBlanks None) : fill withBlanks (take k answers ++ [value] ++ drop k answers) = fill (&lt;[getKthBlank withBlanks k := Some value]&gt; withBlanks) answers.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chk9f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka0"><span class="nb">destruct</span> (fillSplit value (take k answers) (drop k answers) withBlanks k) <span class="kr">as</span> [H1 [H2 H3]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k = length (take k answers)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chka1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chka1"><hr></label><div class="goal-conclusion">length (take k answers ++ [value] ++ drop k answers) =
count_occ decide withBlanks None</div></blockquote><input class="alectryon-extra-goal-toggle" id="Completion-v-chka2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chka2"><hr></label><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k = length (take k answers)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka4"><span class="nb">rewrite</span> take_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k = k `min` length answers</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka5">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take k answers ++ [value] ++ drop k answers) =
count_occ decide withBlanks None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chka6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br></div><label class="goal-separator" for="Completion-v-chka6"><hr></label><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka7">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (take k answers ++ [value] ++ drop k answers) =
count_occ decide withBlanks None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> fillInOneBlank_h1Parameter.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka8">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chka9"><span class="nb">pose proof</span> fillApp (take (getKthBlank withBlanks k) withBlanks) ([None] ++ (drop (S (getKthBlank withBlanks k)) withBlanks)) (take k answers) ([value] ++ drop k answers) H2 <span class="kp">ltac</span>:(<span class="nb">rewrite</span> !app_length, !count_occ_app; <span class="nb">simpl</span>; <span class="nb">destruct</span> (decide _ _); (<span class="bp">lia</span> || <span class="bp">done</span>)) <span class="kr">as</span> step1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill
  (take (getKthBlank withBlanks k) withBlanks ++
   [None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks)
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkaa"><span class="nb">rewrite</span> &lt;- H1 <span class="kr">in</span> step1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkab"><span class="nb">rewrite</span> step1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)
  ([value] ++ drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkac"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkad"><span class="nb">pose proof</span> getKthBlankUpperBound _ _ hReasonable <span class="kr">as</span> hUpperBound.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkae"><span class="nb">pose proof</span> updateAppZero (take (getKthBlank withBlanks k) withBlanks) ([nth (getKthBlank withBlanks k) withBlanks None] ++ drop (S (getKthBlank withBlanks k)) withBlanks) (Some value) <span class="kr">as</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[length
    (take (getKthBlank withBlanks k) withBlanks):=
  Some value]&gt;
  (take (getKthBlank withBlanks k) withBlanks ++
   [nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks) =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkaf"><span class="nb">rewrite</span> &lt;- (listDecompositionSingle withBlanks (getKthBlank withBlanks k) hUpperBound None) <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[length
    (take (getKthBlank withBlanks k) withBlanks):=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb0"><span class="nb">rewrite</span> take_length <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb1"><span class="nb">assert</span> (hMin : getKthBlank withBlanks k `min` length withBlanks = getKthBlank withBlanks k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k `min` length withBlanks =
getKthBlank withBlanks k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Completion-v-chkb2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><label class="goal-separator" for="Completion-v-chkb2"><hr></label><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks k `min` length withBlanks =
getKthBlank withBlanks k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb4">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k `min` length withBlanks:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb5"><span class="nb">rewrite</span> hMin <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb6"><span class="nb">rewrite</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks ++
   &lt;[<span class="mi">0</span>:=Some value]&gt;
     ([nth (getKthBlank withBlanks k) withBlanks None] ++
      drop (S (getKthBlank withBlanks k)) withBlanks))
  answers</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb7"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k)) withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb8"><span class="nb">pose proof</span> fillApp (take (getKthBlank withBlanks k) withBlanks) (Some value :: drop (S (getKthBlank withBlanks k)) withBlanks) (take k answers) (drop k answers) <span class="kp">ltac</span>:(<span class="nb">rewrite</span> take_length, takeKthBlankCountOcc; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">lia</span>) <span class="kp">ltac</span>:(<span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">destruct</span> (decide _ _)) <span class="kr">as</span> hPartial.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>hPartial</var><span class="hyp-type"><b>: </b><span>fill
  (take (getKthBlank withBlanks k)
     withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks)
  (take k answers ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k)
     withBlanks) (take k answers) ++
fill
  (Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) (drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k)) withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkb9"><span class="nb">rewrite</span> take_drop <span class="kr">in</span> hPartial.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>hPartial</var><span class="hyp-type"><b>: </b><span>fill
  (take (getKthBlank withBlanks k)
     withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) answers =
fill
  (take (getKthBlank withBlanks k)
     withBlanks) (take k answers) ++
fill
  (Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) (drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k)) withBlanks)
  answers</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkba"><span class="nb">rewrite</span> hPartial.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>hPartial</var><span class="hyp-type"><b>: </b><span>fill
  (take (getKthBlank withBlanks k)
     withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) answers =
fill
  (take (getKthBlank withBlanks k)
     withBlanks) (take k answers) ++
fill
  (Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) (drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  (Some value
   :: drop (S (getKthBlank withBlanks k)) withBlanks)
  (drop k answers)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkbb"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>answers</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>length answers + <span class="mi">1</span> =
count_occ decide withBlanks None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
[None] ++
drop (S (getKthBlank withBlanks k)) withBlanks</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>length (take k answers) =
count_occ decide
  (take (getKthBlank withBlanks k) withBlanks)
  None</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>length (drop k answers) =
count_occ decide
  (drop (S (getKthBlank withBlanks k)) withBlanks)
  None</span></span></span><br><span><var>step1</var><span class="hyp-type"><b>: </b><span>fill withBlanks
  (take k answers ++ [value] ++ drop k answers) =
fill
  (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
fill
  ([None] ++
   drop (S (getKthBlank withBlanks k))
     withBlanks) ([value] ++ drop k answers)</span></span></span><br><span><var>hUpperBound</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k &lt;
length withBlanks</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>&lt;[getKthBlank withBlanks k:=
  Some value]&gt; withBlanks =
take (getKthBlank withBlanks k) withBlanks ++
&lt;[<span class="mi">0</span>:=Some value]&gt;
  ([nth (getKthBlank withBlanks k) withBlanks None] ++
   drop (S (getKthBlank withBlanks k)) withBlanks)</span></span></span><br><span><var>hMin</var><span class="hyp-type"><b>: </b><span>getKthBlank withBlanks k
`min` length withBlanks =
getKthBlank withBlanks k</span></span></span><br><span><var>hPartial</var><span class="hyp-type"><b>: </b><span>fill
  (take (getKthBlank withBlanks k)
     withBlanks ++
   Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) answers =
fill
  (take (getKthBlank withBlanks k)
     withBlanks) (take k answers) ++
fill
  (Some value
   :: drop (S (getKthBlank withBlanks k))
        withBlanks) (drop k answers)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers) =
fill (take (getKthBlank withBlanks k) withBlanks)
  (take k answers) ++
value
:: fill
     (drop (S (getKthBlank withBlanks k)) withBlanks)
     (drop k answers)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkbc"><span class="kn">Lemma</span> <span class="nf">partialCompletionSelf</span> (<span class="nv">x</span> : list (option A)) : isPartialCompletion x x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion x x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkbd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion x x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> x <span class="kr">as</span> [| [head |] tail IH]; <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">rewrite</span> <span class="nl">?andb_True</span>, <span class="nl">?bool_decide_spec</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkbe"><span class="kn">Lemma</span> <span class="nf">updateKthPartialCompletion</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">k</span> : nat) (<span class="nv">hReasonable</span> : k &lt; count_occ decide withBlanks None) (<span class="nv">value</span> : A) : isPartialCompletion withBlanks (&lt;[getKthBlank withBlanks k := Some value]&gt; withBlanks).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion withBlanks
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkbf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>k &lt; count_occ decide withBlanks None</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isPartialCompletion withBlanks
  (&lt;[getKthBlank withBlanks k:=Some value]&gt; withBlanks)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> k, hReasonable |- *; <span class="kp">try</span> <span class="bp">easy</span>;
  <span class="nb">destruct</span> k; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">rewrite</span> <span class="nl">?andb_True</span>, <span class="nl">?bool_decide_spec</span>;
  ((<span class="kp">try</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>; <span class="nb">apply</span> IH; <span class="nb">destruct</span> (decide _ _); (<span class="bp">done</span> || <span class="bp">lia</span>)) || <span class="nb">apply</span> partialCompletionSelf).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkc0"><span class="kn">Lemma</span> <span class="nf">getKthBlankLt</span> (<span class="nv">withBlanks</span> : list (option A)) (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">hReasonable</span> : j &lt; count_occ decide withBlanks None) (<span class="nv">hLt</span> : i &lt; j) : getKthBlank withBlanks i &lt; getKthBlank withBlanks j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks i &lt; getKthBlank withBlanks j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkc1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks i &lt; getKthBlank withBlanks j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Completion-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="Completion-v-chkc2"><span class="nb">pose proof</span> (<span class="kp">ltac</span>:(<span class="nb">intros</span>; <span class="bp">lia</span>) : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : nat, x &lt; y -&gt; S x &lt; S y) <span class="kr">as</span> m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>_0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>decide</var><span class="hyp-type"><b>: </b><span>EqDecision (option A)</span></span></span><br><span><var>withBlanks</var><span class="hyp-type"><b>: </b><span>list (option A)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hReasonable</var><span class="hyp-type"><b>: </b><span>j &lt; count_occ decide withBlanks None</span></span></span><br><span><var>hLt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">_0</span> <span class="nv">_1</span> : nat, _0 &lt; _1 ‚Üí S _0 &lt; S _1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">getKthBlank withBlanks i &lt; getKthBlank withBlanks j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> withBlanks <span class="kr">as</span> [| [head |] tail IH] <span class="kr">in</span> i, j, hReasonable, hLt |- *; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">destruct</span> i <span class="kr">as</span> [| i]; <span class="nb">destruct</span> j <span class="kr">as</span> [| j]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (decide _ _); <span class="kp">try</span> (<span class="bp">done</span> || <span class="bp">lia</span>); <span class="nb">apply</span> m, IH; (<span class="bp">done</span> || <span class="bp">lia</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Completion</span>.</span><span class="alectryon-wsp">
</span></span></pre></article></body></html>